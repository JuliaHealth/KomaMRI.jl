<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Create Your Own Phantom · KomaMRI.jl</title><meta name="title" content="Create Your Own Phantom · KomaMRI.jl"/><meta property="og:title" content="Create Your Own Phantom · KomaMRI.jl"/><meta property="twitter:title" content="Create Your Own Phantom · KomaMRI.jl"/><meta name="description" content="Documentation for KomaMRI.jl."/><meta property="og:description" content="Documentation for KomaMRI.jl."/><meta property="twitter:description" content="Documentation for KomaMRI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/hide-documenter-example-output.css" rel="stylesheet" type="text/css"/><link href="../../assets/center-images.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="KomaMRI.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="KomaMRI.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">🏠 Home</a></li><li><a class="tocitem" href="../1-getting-started/">🏃 Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">🏋️ Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial/01-FID/">Free Induction Decay</a></li><li><a class="tocitem" href="../../tutorial/02-SmallTipApproximation/">Small Tip Angle Approximation</a></li><li><a class="tocitem" href="../../tutorial/03-ChemicalShiftEPI/">Chemical Shift in an EPI sequence</a></li><li><a class="tocitem" href="../../tutorial/04-3DSliceSelective/">Slice-Selective Acquisition of 3D Phantom</a></li><li><a class="tocitem" href="../../tutorial/05-SimpleMotion/">Patient&#39;s Motion During Acquisition</a></li><li><a class="tocitem" href="../../tutorial/06-DiffusionMotion/">Diffusion-induced Signal Attenuation</a></li><li><a class="tocitem" href="../../tutorial/07-RRVariability/">Cardiac Cine MRI with Arrhythmias</a></li><li><a class="tocitem" href="../../tutorial/07-label/">Using Labels to reconstruct multi-slice / multi-contrast sequences</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">🧑‍🔬 Reproducible Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences</a></li><li><a class="tocitem" href="../../tutorial-pluto/02-low-field-cmra-optimization/">Low-Field CMRA Optimization</a></li><li><a class="tocitem" href="../../tutorial-pluto/03-low-field-boost-optimization/">Low-Field BOOST Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox" checked/><label class="tocitem" for="menuitem-5"><span class="docs-label">👨‍🍳 How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../2-1-use-koma-ui/">Use Koma&#39;s User Interface</a></li><li><a class="tocitem" href="../2-2-use-koma-notebooks/">Use Koma in Notebooks</a></li><li><a class="tocitem" href="../2-3-use-koma-scripts/">Use Koma in Julia Scripts</a></li><li class="is-active"><a class="tocitem" href>Create Your Own Phantom</a><ul class="internal"><li><a class="tocitem" href="#Basic-case:-1-spin-phantom"><span>Basic case: 1-spin phantom</span></a></li><li><a class="tocitem" href="#Loading-phantom-data-from-a-.mat-file"><span>Loading phantom data from a .mat file</span></a></li><li><a class="tocitem" href="#Creating-a-custom-flow-cylinder-phantom"><span>Creating a custom flow cylinder phantom</span></a></li><li><a class="tocitem" href="#Importing/exporting-phantoms-(.phantom-file-format)"><span>Importing/exporting phantoms (.phantom file format)</span></a></li></ul></li><li><a class="tocitem" href="../3-create-your-own-sequence/">Create Your Own Sequence</a></li><li><a class="tocitem" href="../4-run-distributed-simulations/">Run Distributed Simulations</a></li><li><a class="tocitem" href="../5-contribute-to-koma/">Contribute to Koma</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">🤔 Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanation/1-phantom/">Phantom</a></li><li><a class="tocitem" href="../../explanation/2-motion/">Motion</a></li><li><a class="tocitem" href="../../explanation/3-phantom-format/">Phantom File Format</a></li><li><a class="tocitem" href="../../explanation/4-sequence/">Sequence</a></li><li><a class="tocitem" href="../../explanation/5-seq-events/">Sequence Events</a></li><li><a class="tocitem" href="../../explanation/6-simulation/">Simulation</a></li><li><a class="tocitem" href="../../explanation/7-gpu-explanation/">GPU Parallelization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">👨‍💻 Reference Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/1-api/">API Overview</a></li><li><a class="tocitem" href="../../reference/2-koma-base/">KomaMRIBase</a></li><li><a class="tocitem" href="../../reference/3-koma-core/">KomaMRICore</a></li><li><a class="tocitem" href="../../reference/4-koma-files/">KomaMRIFiles</a></li><li><a class="tocitem" href="../../reference/5-koma-plots/">KomaMRIPlots</a></li><li><a class="tocitem" href="../../reference/6-koma-mri/">KomaMRI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">👨‍🍳 How to</a></li><li class="is-active"><a href>Create Your Own Phantom</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Create Your Own Phantom</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl/blob/master/docs/src/how-to/3-create-your-own-phantom.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Create-Your-Own-Phantom"><a class="docs-heading-anchor" href="#Create-Your-Own-Phantom">Create Your Own Phantom</a><a id="Create-Your-Own-Phantom-1"></a><a class="docs-heading-anchor-permalink" href="#Create-Your-Own-Phantom" title="Permalink"></a></h1><p>In this section, we will create some custom <strong>Phantom</strong> structs.</p><p>In <strong>KomaMRI</strong>, the creation of a <strong>Phantom</strong> struct involves defining spin position arrays (x, y, z) and spin property arrays.  The indices of these arrays are then associated with independent spins. See the <a href="../../explanation/lit-1-phantom.jl">Phantom explanation section</a> for more information about how digital phantoms work in KomaMRI. </p><h2 id="Basic-case:-1-spin-phantom"><a class="docs-heading-anchor" href="#Basic-case:-1-spin-phantom">Basic case: 1-spin phantom</a><a id="Basic-case:-1-spin-phantom-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-case:-1-spin-phantom" title="Permalink"></a></h2><p>You can create a <strong>Phantom</strong> with one spin like so:</p><pre><code class="language-julia hljs"># Define arrays of positions (spin at zero position)
x = [0.0]
y = [0.0]
z = [0.0]

# Define arrays of properties (for CSF tissue)
ρ = [1.0]
T1 = [2.569]
T2 = [0.329]
T2s = [0.058]

# Define the phantom
spin = Phantom(name=&quot;spin&quot;, x=x, y=y, z=z, ρ=ρ, T1=T1, T2=T2, T2s=T2s)</code></pre><pre><code class="language-julia-repl hljs">Phantom{Float64}
  name: String &quot;spin&quot;
  x: Array{Float64}((1,)) [0.0]
  y: Array{Float64}((1,)) [0.0]
  z: Array{Float64}((1,)) [0.0]
  ρ: Array{Float64}((1,)) [1.0]
  T1: Array{Float64}((1,)) [2.569]
  T2: Array{Float64}((1,)) [0.329]
  T2s: Array{Float64}((1,)) [0.058]
  Δw: Array{Float64}((1,)) [0.0]
  Dλ1: Array{Float64}((1,)) [0.0]
  Dλ2: Array{Float64}((1,)) [0.0]
  Dθ: Array{Float64}((1,)) [0.0]
  motion: NoMotion NoMotion()</code></pre><p>You can add more properties to the <strong>Phantom</strong>, such as off-resonance, diffusion parameters, and even <a href="../../explanation/2-motion/">motion</a> information.</p><h2 id="Loading-phantom-data-from-a-.mat-file"><a class="docs-heading-anchor" href="#Loading-phantom-data-from-a-.mat-file">Loading phantom data from a .mat file</a><a id="Loading-phantom-data-from-a-.mat-file-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-phantom-data-from-a-.mat-file" title="Permalink"></a></h2><p>If you are familiar with the <strong>MRI</strong> world, you likely have a 2D or 3D array, where each element contains an ID number identifying a different class of tissue. In this setup, the array axes represent spatial positions, while the elements are used for tissue identification.</p><p>In this example, we will utilize a <code>.mat</code> file containing arrays with such arrangements. The file is readily available upon installing <strong>KomaMRI</strong>. Let&#39;s read the file and store the 2D data in an array called <code>class</code>:</p><pre><code class="language-julia hljs"># Get data from a .mat file
path_koma = dirname(dirname(pathof(KomaMRI)))
path_phantom_mat = joinpath(path_koma, &quot;KomaMRIBase&quot;, &quot;src&quot;, &quot;datatypes&quot;, &quot;phantom&quot;, &quot;pelvis2D.mat&quot;)
data = KomaMRIFiles.matread(path_phantom_mat)
class = data[&quot;pelvis3D_slice&quot;]</code></pre><p>You can visualize the tissue map using the <a href="../../reference/5-koma-plots/#KomaMRIPlots.plot_image"><code>plot_image</code></a> function:</p><pre><code class="language-julia hljs">plot_image(class)</code></pre><center><object type="text/html" data="../../assets/create-your-own-phantom-class-map.html" style="width:85%; height:470px;"></object></center><p>Let&#39;s define the position arrays. You need to know the distance between the spins in the original array (in this case, it is 0.5mm), and then you can determine all the positions like this (the z-component is not calculated since this is a 2D example):</p><pre><code class="language-julia hljs"># Define spin position arrays
Δx = .5e-3                  # 0.5mm
M, N = size(class)          # Number of spins in x and y
FOVx = (M-1)*Δx             # Field of view in x
FOVy = (N-1)*Δx             # Field of view in y
x = -FOVx/2:Δx:FOVx/2       # x spin coordinates vector
y = -FOVy/2:Δx:FOVy/2       # y spin coordinates vector
x, y = x .+ y&#39;*0, x*0 .+ y&#39; # x and y grid points</code></pre><p>Now, let&#39;s define the arrays for the properties. It&#39;s essential to have prior knowledge of the property values for different tissue classes. For example, for soft tissue, we use <code>ρ = 0.9</code>, <code>T1 = 1200 * 1e-3</code>, <code>T2 = 80 * 1e-3</code>, and <code>T2s = 80 * 1e-3</code>. Additionally, we create an array mask to identify the location of a tissue&#39;s ID. For soft tissue with ID = 153, the mask is <code>(class .== 153)</code>. Finally, to obtain a property, sum all the masks with values for all tissue classes. This process is illustrated below: </p><pre><code class="language-julia hljs"># Define the proton density array
ρ = (class.==102)*.86 .+    # Fat
    (class.==153)*.9 .+     # SoftTissue
    (class.==204)*.4 .+     # SpongyBone
    (class.==255)*.2        # CorticalBone

# Define the T1 decay array
T1 = (class.==102)*366 .+   # Fat
    (class.==153)*1200 .+   # SoftTissue
    (class.==204)*381 .+    # SpongyBone
    (class.==255)*100       # CorticalBone

# Define the T2 decay array
T2 = (class.==102)*70 .+    # Fat
    (class.==153)*80 .+     # SoftTissue
    (class.==204)*52 .+     # SpongyBone
    (class.==255)*.3        # CorticalBone

# Define the T2s decay array
T2s = (class.==102)*70 .+   # Fat
    (class.==153)*80 .+     # SoftTissue
    (class.==204)*52 .+     # SpongyBone
    (class.==255)*.3        # CorticalBone

# Define off-resonance array
Δw_fat = -220 * 2π
Δw = (class.==102) * Δw_fat # FAT1

# Adjust with scaling factor
T1 = T1*1e-3
T2 = T2*1e-3
T2s = T2s*1e-3</code></pre><p>Finally, we can invoke the <a href="../../reference/2-koma-base/#KomaMRIBase.Phantom"><code>Phantom</code></a> constructor. However, before doing so, we choose not to store spins where the proton density is zero to avoid unnecessary data storage. This is achieved by applying the mask <code>ρ.!=0</code> to the arrays. Additionally, please note that we set the z-position array filled with zeros.</p><pre><code class="language-julia hljs"># Define the phantom
obj = Phantom(
    name = &quot;custom-pelvis&quot;,
	x = x[ρ.!=0],
	y = y[ρ.!=0],
	z = 0*x[ρ.!=0],
	ρ = ρ[ρ.!=0],
	T1 = T1[ρ.!=0],
	T2 = T2[ρ.!=0],
	T2s = T2s[ρ.!=0],
	Δw = Δw[ρ.!=0],
)</code></pre><p>We can display the <strong>Phantom</strong> struct with the <a href="../../reference/5-koma-plots/#KomaMRIPlots.plot_phantom_map"><code>plot_phantom_map</code></a> function. In this case we select the T1 decay to be displayed, but you can choose other property to be displayed:</p><pre><code class="language-julia hljs">plot_phantom_map(obj, :T1)</code></pre><object type="text/html" data="../../assets/create-your-own-phantom-pelvis-T1.html" style="width:85%; height:470px;"></object><h2 id="Creating-a-custom-flow-cylinder-phantom"><a class="docs-heading-anchor" href="#Creating-a-custom-flow-cylinder-phantom">Creating a custom flow cylinder phantom</a><a id="Creating-a-custom-flow-cylinder-phantom-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-custom-flow-cylinder-phantom" title="Permalink"></a></h2><p>This section shows how to create a slightly more complex phantom, which includes flow, from scratch. </p><p>The phantom is modelled as a vertical cylindrical tube, with outer radius of 10 mm, an inner radius of 4.5 mm, and a length of 40 mm.</p><p>First, we generate the 3D grid that defines the spatial layaout of the spins:</p><pre><code class="language-julia hljs">R = 10e-3; r = 4.5e-3; L = 40e-3; Δx = 1e-3

#POSITIONS
x = -R:Δx:R
y = -R:Δx:R 
z = -L/2:Δx:L/2

xx = reshape(x, (length(x),1,1)) 
yy = reshape(y, (1,length(y),1)) 
zz = reshape(z, (1,1,length(z))) 

# Grid
x = 1*xx .+ 0*yy .+ 0*zz
y = 0*xx .+ 1*yy .+ 0*zz
z = 0*xx .+ 0*yy .+ 1*zz</code></pre><p>Then, we separate the grid into two regions. The boolean array <code>bl</code> marks the inner part of the tube, where the &quot;blood&quot; spins should flow,  while the <code>ts</code> array identifies the surrounding tissue, which must remain static. The <code>⚪(R)</code> function helps us with this task:</p><pre><code class="language-julia hljs">⚪(R) =  (x.^2 .+ y.^2 .&lt;= R^2) # circle of radius R

ts = Bool.(⚪(R) - ⚪(r))
bl = Bool.(⚪(r))</code></pre><p>Once each region is defined, we can go ahead and create the phantom. It is often convenient to generate the phantoms for each region separately. Let&#39;s start with the static outer <code>tissue</code>, which is very straightforward. We’ll assign it PD, T1, and T2 values of 1.0, 700 ms, and 42 ms, respectively:</p><pre><code class="language-julia hljs">PD = 1.0; T1 = 700e-3; T2 = 42e-3

tissue = Phantom(
    name=&quot;Tissue&quot;,
    x=x[ts],
    y=y[ts],
    z=z[ts],
    ρ=PD.*ones(length(x[ts])),
    T1=T1.*ones(length(x[ts])),
    T2=T2.*ones(length(x[ts]))
)</code></pre><pre><code class="language-julia-repl hljs">Phantom{Float64}
  name: String &quot;Tissue&quot;
  x: Array{Float64}((10168,)) [0.0, -0.004, -0.003, -0.002, -0.001  …  0.0, 0.001, 0.002, 0.003, 0.004, 0.0]
  y: Array{Float64}((10168,)) [-0.01, -0.009, -0.009, -0.009, -0.009  …  0.009, 0.009, 0.009, 0.009, 0.01]
  z: Array{Float64}((10168,)) [-0.02, -0.02, -0.02, -0.02, -0.02  …  0.02, 0.02, 0.02, 0.02, 0.02, 0.02]
  ρ: Array{Float64}((10168,)) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
  T1: Array{Float64}((10168,)) [0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7  …  0.7, 0.7, 0.7, 0.7, 0.7, 0.7, 0.7]
  T2: Array{Float64}((10168,)) [0.042, 0.042, 0.042, 0.042, 0.042  …  0.042, 0.042, 0.042, 0.042, 0.042]
  T2s: Array{Float64}((10168,)) [1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6  …  1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6]
  Δw: Array{Float64}((10168,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((10168,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ2: Array{Float64}((10168,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dθ: Array{Float64}((10168,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  motion: NoMotion NoMotion()</code></pre><p>Now, we repeat the process for the <code>blood</code> spins inside the tube. For this region, the PD, T1, and T2 values will be 0.9, 1200 ms, and 92 ms, respectively.</p><p>To define the flow movement for these inner spins, we need to create a <a href="../../reference/2-koma-base/#KomaMRIBase.FlowPath"><code>FlowPath</code></a> motion. This will include both the trajectories followed by each spin and the flags that indicate when a spin leaves the phantom&#39;s domain (at the upper end) and is reinjected at the lower end of the cylinder:</p><pre><code class="language-julia hljs">PD = 0.9; T1 = 1200e-3; T2 = 92e-3

Nt = 500    # Number of discrete time nodes
v  = 200e-3 # 200 mm/s 

dx = dy = zeros(length(z[bl]), Nt)
dz =z[bl] .+ cumsum(L/Nt .+ zeros(1,Nt), dims=2)

spin_reset = dz .&gt; L/2
for i in 1:size(spin_reset, 1)
    idx = findfirst(x -&gt; x == 1, spin_reset[i, :])
    if idx !== nothing
        spin_reset[i, :]  .= 0
        spin_reset[i, idx] = 1 # Activate the flag at the NEXT node after the jump
    end
end

dz[dz .&gt; L/2] .-= L
dz .-= z[bl]

blood = Phantom(
    name=&quot;Blood&quot;,
    x=x[bl],
    y=y[bl],
    z=z[bl],
    ρ =PD.*ones(length(x[bl])),
    T1=T1.*ones(length(x[bl])),
    T2=T2.*ones(length(x[bl])),
    motion=FlowPath(dx, dy, dz, spin_reset, Periodic(L/v, 1.0-1e-6))
)</code></pre><pre><code class="language-julia-repl hljs">Phantom{Float64}
  name: String &quot;Blood&quot;
  x: Array{Float64}((2829,)) [-0.002, -0.001, 0.0, 0.001, 0.002  …  -0.002, -0.001, 0.0, 0.001, 0.002]
  y: Array{Float64}((2829,)) [-0.004, -0.004, -0.004, -0.004  …  0.004, 0.004, 0.004, 0.004, 0.004]
  z: Array{Float64}((2829,)) [-0.02, -0.02, -0.02, -0.02, -0.02  …  0.02, 0.02, 0.02, 0.02, 0.02, 0.02]
  ρ: Array{Float64}((2829,)) [0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9  …  0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
  T1: Array{Float64}((2829,)) [1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2  …  1.2, 1.2, 1.2, 1.2, 1.2, 1.2, 1.2]
  T2: Array{Float64}((2829,)) [0.092, 0.092, 0.092, 0.092, 0.092  …  0.092, 0.092, 0.092, 0.092, 0.092]
  T2s: Array{Float64}((2829,)) [1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6  …  1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6]
  Δw: Array{Float64}((2829,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((2829,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ2: Array{Float64}((2829,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dθ: Array{Float64}((2829,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  motion: Motion{Float64}</code></pre><p>Last, we obtain the final <code>obj</code> as the sum of both phantoms:</p><pre><code class="language-julia hljs">obj = tissue + blood

plot_phantom_map(obj, :T1; time_samples=11)</code></pre><object type="text/html" data="../../assets/create-your-own-phantom-flow-T1.html" style="width:85%; height:470px;"></object><h2 id="Importing/exporting-phantoms-(.phantom-file-format)"><a class="docs-heading-anchor" href="#Importing/exporting-phantoms-(.phantom-file-format)">Importing/exporting phantoms (.phantom file format)</a><a id="Importing/exporting-phantoms-(.phantom-file-format)-1"></a><a class="docs-heading-anchor-permalink" href="#Importing/exporting-phantoms-(.phantom-file-format)" title="Permalink"></a></h2><p>Another option to create your own phantom is to import it directly from a <a href="../../explanation/3-phantom-format/"><code>.phantom</code></a> file. To demonstrate this, we will first create the file from the previous phantom, using the <a href="../../reference/4-koma-files/#KomaMRIFiles.write_phantom"><code>write_phantom</code></a> function, and then we will read it using the <a href="../../reference/4-koma-files/#KomaMRIFiles.read_phantom"><code>read_phantom</code></a> function:</p><pre><code class="language-julia-repl hljs">julia&gt; write_phantom(obj, &quot;flow_cylinder.phantom&quot;)
# Now, you could even close Julia, turn off your computer...
julia&gt; obj2 = read_phantom(&quot;flow_cylinder.phantom&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../2-3-use-koma-scripts/">« Use Koma in Julia Scripts</a><a class="docs-footer-nextpage" href="../3-create-your-own-sequence/">Create Your Own Sequence »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Monday 29 September 2025 19:16">Monday 29 September 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
