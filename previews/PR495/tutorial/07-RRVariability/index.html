<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cardiac Cine MRI with Arrhythmias · KomaMRI.jl</title><meta name="title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta property="og:title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta property="twitter:title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta name="description" content="Documentation for KomaMRI.jl."/><meta property="og:description" content="Documentation for KomaMRI.jl."/><meta property="twitter:description" content="Documentation for KomaMRI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/hide-documenter-example-output.css" rel="stylesheet" type="text/css"/><link href="../../assets/center-images.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="KomaMRI.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="KomaMRI.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">🏠 Home</a></li><li><a class="tocitem" href="../../how-to/1-getting-started/">🏃 Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">🏋️ Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01-FID/">Free Induction Decay</a></li><li><a class="tocitem" href="../02-SmallTipApproximation/">Small Tip Angle Approximation</a></li><li><a class="tocitem" href="../03-ChemicalShiftEPI/">Chemical Shift in an EPI sequence</a></li><li><a class="tocitem" href="../04-3DSliceSelective/">Slice-Selective Acquisition of 3D Phantom</a></li><li><a class="tocitem" href="../05-SimpleMotion/">Patient&#39;s Motion During Acquisition</a></li><li><a class="tocitem" href="../06-DiffusionMotion/">Diffusion-induced Signal Attenuation</a></li><li class="is-active"><a class="tocitem" href>Cardiac Cine MRI with Arrhythmias</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">🧑‍🔬 Reproducible Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences</a></li><li><a class="tocitem" href="../../tutorial-pluto/02-low-field-cmra-optimization/">Low-Field CMRA Optimization</a></li><li><a class="tocitem" href="../../tutorial-pluto/03-low-field-boost-optimization/">Low-Field BOOST Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">👨‍🍳 How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how-to/2-1-use-koma-ui/">Use Koma&#39;s User Interface</a></li><li><a class="tocitem" href="../../how-to/2-2-use-koma-notebooks/">Use Koma in Notebooks</a></li><li><a class="tocitem" href="../../how-to/2-3-use-koma-scripts/">Use Koma in Julia Scripts</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-phantom/">Create Your Own Phantom</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-sequence/">Create Your Own Sequence</a></li><li><a class="tocitem" href="../../how-to/4-run-distributed-simulations/">Run Distributed Simulations</a></li><li><a class="tocitem" href="../../how-to/5-contribute-to-koma/">Contribute to Koma</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">🤔 Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanation/1-phantom/">Phantom</a></li><li><a class="tocitem" href="../../explanation/2-motion/">Motion</a></li><li><a class="tocitem" href="../../explanation/3-phantom-format/">Phantom File Format</a></li><li><a class="tocitem" href="../../explanation/4-sequence/">Sequence</a></li><li><a class="tocitem" href="../../explanation/5-seq-events/">Sequence Events</a></li><li><a class="tocitem" href="../../explanation/6-simulation/">Simulation</a></li><li><a class="tocitem" href="../../explanation/7-gpu-explanation/">GPU Parallelization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">👨‍💻 Reference Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/1-api/">API Overview</a></li><li><a class="tocitem" href="../../reference/2-koma-base/">KomaMRIBase</a></li><li><a class="tocitem" href="../../reference/3-koma-core/">KomaMRICore</a></li><li><a class="tocitem" href="../../reference/4-koma-files/">KomaMRIFiles</a></li><li><a class="tocitem" href="../../reference/5-koma-plots/">KomaMRIPlots</a></li><li><a class="tocitem" href="../../reference/6-koma-mri/">KomaMRI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">🏋️ Tutorials</a></li><li class="is-active"><a href>Cardiac Cine MRI with Arrhythmias</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cardiac Cine MRI with Arrhythmias</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl/blob/master/docs/src/tutorial/lit-07-RRVariability.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Cardiac-Cine-MRI-with-Arrhythmias"><a class="docs-heading-anchor" href="#Cardiac-Cine-MRI-with-Arrhythmias">Cardiac Cine MRI with Arrhythmias</a><a id="Cardiac-Cine-MRI-with-Arrhythmias-1"></a><a class="docs-heading-anchor-permalink" href="#Cardiac-Cine-MRI-with-Arrhythmias" title="Permalink"></a></h1><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Scanner
  B0: Float64 1.5
  B1: Float64 1.0e-5
  Gmax: Float64 0.06
  Smax: Int64 500
  ADC_Δt: Float64 2.0e-6
  seq_Δt: Float64 1.0e-5
  GR_Δt: Float64 1.0e-5
  RF_Δt: Float64 1.0e-6
  RF_ring_down_T: Float64 2.0e-5
  RF_dead_time_T: Float64 0.0001
  ADC_dead_time_T: Float64 1.0e-5
</code></pre><p><a href="../07-RRVariability.jl"><img src="https://img.shields.io/badge/julia-script-9558B2?logo=julia" alt/></a> <a href="../07-RRVariability.ipynb"><img src="https://img.shields.io/badge/jupyter-notebook-blue?logo=jupyter" alt/></a> <a href="https://mybinder.org/v2/gh/JuliaHealth/KomaMRI.jl/master?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FJuliaHealth%252FKomaMRI.jl%26urlpath%3Dlab%252Ftree%252FKomaMRI.jl%252Fdev%252Ftutorial%252F07-RRVariability.ipynb%26branch%3Dgh-pages"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><p>This tutorial shows how to simulate cardiac cine MRI using Koma, including cases with variable RR intervals (i.e., arrhythmias). You&#39;ll learn how to:</p><ol><li>Simulate a clean cine acquisition with constant RR intervals.</li><li>Introduce arrhythmias (variable RR intervals) into the cardiac phantom.</li><li>Observe how this desynchronization degrades image quality.</li><li>Correct the acquisition by synchronizing the sequence with the phantom’s RR variability (manual triggering).</li></ol><h3 id="1.-Constant-RR-for-Phantom-and-Sequence"><a class="docs-heading-anchor" href="#1.-Constant-RR-for-Phantom-and-Sequence">1. Constant RR for Phantom and Sequence</a><a id="1.-Constant-RR-for-Phantom-and-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Constant-RR-for-Phantom-and-Sequence" title="Permalink"></a></h3><p>We will begin by simulating a cardiac cine on a myocardial phantom with a constant RR interval. We&#39;ll use the <code>heart_phantom</code> function to create a ring-shaped phantom filled with blood, resembling the left ventricle:</p><pre><code class="language-julia hljs">obj = heart_phantom()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phantom{Float64}
  name: String &quot;LeftVentricle&quot;
  x: Array{Float64}((12714,)) [-0.007573593128807149, -0.006866486347620604, -0.006159379566434059, -0.005452272785247507, -0.004745166004060962, -0.004038059222874417, -0.003330952441687865, -0.00262384566050132, -0.001916738879314775, -0.001209632098128223  …  -0.001916738879314775, -0.001209632098128223, -0.000502525316941678, 0.000204581464244874, 0.000911688245431419, 0.001618795026617964, 0.002325901807804516, 0.003033008588991061, 0.003740115370177606, 0.004447222151364158]
  y: Array{Float64}((12714,)) [-0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762  …  0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736]
  z: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  ρ: Array{Float64}((12714,)) [0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9  …  0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
  T1: Array{Float64}((12714,)) [1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026  …  1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026]
  T2: Array{Float64}((12714,)) [0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042  …  0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042]
  T2s: Array{Float64}((12714,)) [1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6  …  1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6]
  Δw: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((12714,)) [2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9  …  2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9]
  Dλ2: Array{Float64}((12714,)) [1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10  …  1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10]
  Dθ: Array{Float64}((12714,)) [-0.16916284697591719, -0.1536287198547715, -0.1380195046747176, -0.12234231369025762, -0.10660445476529863, -0.090813412529144, -0.07497682827307205, -0.05910247871255467, -0.0431982537552276, -0.02727213342817287  …  -3.0987888698389616, -3.114569742820848, -3.130364088806849, 3.137021268443483, 3.121223600397341, 3.1054360932317397, 3.0896665955717584, 3.0739229023532744, 3.058212731905059, 3.0425437035966953]
  motion: MotionList{Float64}
</code></pre><p>By default, this phantom exhibits periodic contraction and rotation with a 1-second period:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/tut-6-phantom1.html&quot;</code></pre><center><object type="text/html" data="../../assets/tut-6-phantom1.html" style="width:90%; height:470px;"></object></center><p>As shown in previous tutorials, the phantom&#39;s motion is defined by its <code>motion</code> field. Until now, this motion has typically consisted of a single <code>Motion</code> component. In this case, however, it consists of two independent motions: a contraction (<code>HeartBeat</code>) and a <code>Rotation</code>. These two are grouped together in a <code>MotionList</code> structure:</p><pre><code class="language-julia hljs">obj.motion</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MotionList{Float64}(Motion{Float64}[Motion{Float64}
  action: HeartBeat{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
, Motion{Float64}
  action: Rotate{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
])</code></pre><pre><code class="language-julia-repl hljs">MotionList{Float64}(Motion{Float64}[Motion{Float64}
    action: HeartBeat{Float64}
    time: TimeCurve{Float64}
    spins: AllSpins AllSpins()
, Motion{Float64}
    action: Rotate{Float64}
    time: TimeCurve{Float64}
    spins: AllSpins AllSpins()
])</code></pre><p>Now, we will create a bSSFP cine sequence with the following parameters:</p><pre><code class="language-julia hljs">RRs          = [1.0]       # [s] constant RR interval
N_matrix     = 50          # image size = N x N
N_phases     = 40          # Number of cardiac phases
FOV          = 0.11        # [m]
TR           = 20e-3       # [s]
flip_angle   = 10          # [º]
adc_duration = 0.2e-3      # [s]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0002</code></pre><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.00041634357 0.0004889136 … 0.00039580208 0.00043058067; 0.000639916 0.00064977235 … 0.0006406375 0.00063584076; … ; 0.0008683754 0.0008465801 … 0.00088997994 0.0008567664; 0.0005873019 0.00057036313 … 0.00063863525 0.000580665]
 Float32[0.0008160015 0.0008036955 … 0.0008020949 0.00078612246; 0.00066013465 0.00075819006 … 0.0006184676 0.0006711902; … ; 0.0006810832 0.0007289487 … 0.0007174967 0.0006967911; 0.0011164035 0.0009831286 … 0.0012504938 0.0010941502]
 Float32[0.0020059466 0.0020121904 … 0.0021199207 0.0020392835; 0.0010374949 0.0010868262 … 0.001052071 0.0010527095; … ; 0.00046227133 0.00051882566 … 0.00048123964 0.0004993648; 0.0014541122 0.0013575044 … 0.0016049191 0.0014563432]
 Float32[0.0020199337 0.0020773802 … 0.0021219444 0.0020859488; 0.0009169206 0.00094571925 … 0.00095193606 0.0009410758; … ; 0.0002754665 0.00028087205 … 0.0002556848 0.00026129396; 0.0012200037 0.0012214687 … 0.0013276726 0.0012608607]
 Float32[0.001430856 0.0013761385 … 0.0014883302 0.0014113653; 0.00071741303 0.00069261336 … 0.000745746 0.00070253527; … ; 0.00047574154 0.0004893765 … 0.000498714 0.00048446385; 0.0009391328 0.0009420257 … 0.000978701 0.00094922906]
 Float32[0.0001907515 0.00026264673 … 0.00018648244 0.00022020868; 0.00060639 0.0006169738 … 0.00060425675 0.000605362; … ; 0.00070097647 0.0006889321 … 0.00071765395 0.00070092175; 0.0006479435 0.0006524587 … 0.00069972733 0.00066712283]
 Float32[0.0017033899 0.0017401834 … 0.0017496677 0.0017296565; 0.0010058625 0.0010109432 … 0.0010404487 0.0010092205; … ; 0.00065654446 0.0006129345 … 0.00066046586 0.00062140205; 0.000879732 0.0009052398 … 0.0009158805 0.00090396556]
 Float32[0.0018958119 0.0018904503 … 0.0018946405 0.0018679511; 0.0011609093 0.0010737486 … 0.0011542529 0.0010954574; … ; 0.0005965107 0.0005298954 … 0.00061337603 0.00056097587; 0.00088997884 0.00090259063 … 0.0008267913 0.0008466023]
 Float32[0.0009259143 0.00086041907 … 0.00092888693 0.0008746578; 0.00069339515 0.00062594534 … 0.0007681431 0.0006784288; … ; 0.00057377893 0.0005421978 … 0.0006228952 0.0005495856; 0.00066129596 0.0006946987 … 0.0006252356 0.00064338313]
 Float32[0.00032739097 0.00033655143 … 0.00024361062 0.00027344434; 0.0005239255 0.00052854954 … 0.0005308971 0.00051604904; … ; 0.00064441556 0.00064403634 … 0.00065972155 0.0006415509; 0.00061759865 0.0006139895 … 0.00065612316 0.0006332154]
 ⋮
 Float32[0.0015824356 0.0015426226 … 0.0016411145 0.00157121; 0.0007734989 0.0007376755 … 0.0008029426 0.0007598204; … ; 0.0003065103 0.00025029018 … 0.00031102833 0.0002740764; 0.0008300774 0.0008186624 … 0.00085917936 0.0008243147]
 Float32[0.0008247116 0.00076294475 … 0.0008294825 0.0007887611; 0.00033046864 0.00032041394 … 0.0003087587 0.000306664; … ; 0.00016506191 0.00017257142 … 0.0001683491 0.0001743521; 0.000510095 0.00045549675 … 0.00053788745 0.00049159484]
 Float32[0.00016109318 0.00028232078 … 0.00021814342 0.000259696; 0.00026885196 0.00030248114 … 0.00029255447 0.0002999231; … ; 0.00025947325 0.00027517526 … 0.00027129322 0.00026588363; 0.000173014 0.00018774575 … 0.00018874557 0.00018848157]
 Float32[0.0010477979 0.001138397 … 0.0011416427 0.0011452208; 0.00064635364 0.0006639618 … 0.0007108565 0.00067969033; … ; 0.00035315708 0.00033606408 … 0.0003742716 0.00034545106; 0.00055889995 0.0005909212 … 0.0005999383 0.0005906982]
 Float32[0.0015566008 0.0016175915 … 0.0016535931 0.0016317936; 0.0007789956 0.0008288943 … 0.0008247551 0.0008211333; … ; 0.0002957547 0.00032084715 … 0.0002843737 0.000299612; 0.0008723513 0.0008758998 … 0.00095624034 0.0009122724]
 Float32[0.0014529936 0.0015056947 … 0.0015383568 0.0015186652; 0.00062279985 0.00067256467 … 0.00065679394 0.0006732454; … ; 0.00018159735 0.00019595503 … 0.00016561977 0.00018128827; 0.00083098677 0.0008527127 … 0.00091437146 0.0008775152]
 Float32[0.000898584 0.0009059719 … 0.0009186781 0.000901109; 0.0003020888 0.00033642212 … 0.00029225976 0.00031912414; … ; 0.00015928979 0.00016620458 … 0.0001841625 0.00017181292; 0.00052718364 0.0005246724 … 0.00059275434 0.0005503176]
 Float32[6.160923f-5 6.866962f-5 … 0.00010384909 8.038352f-5; 0.00025547395 0.0002455805 … 0.00028865796 0.00026606896; … ; 0.00024371174 0.00024805812 … 0.00029596649 0.00026384124; 0.00016243826 0.00016846864 … 0.00017031636 0.00016289088]
 Float32[0.00092588767 0.0009359369 … 0.0010219836 0.0009693973; 0.0005551997 0.00056545547 … 0.0006180584 0.0005837153; … ; 0.0002467925 0.00025818692 … 0.0002944846 0.00027524127; 0.00066685525 0.0006701958 … 0.0007074313 0.0006854464]</code></pre><p>The simulation and subsequent reconstruction produces the following cine frames, which look clean and temporally coherent:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames1.gif</code></pre><center><object data="../../assets/tut-7-frames1.gif" style="height:400px"></object></center><h3 id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence"><a class="docs-heading-anchor" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence">2. Arrhythmic Phantom: Variable RR, Constant Sequence</a><a id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence" title="Permalink"></a></h3><p>Now, we will introduce arrhythmias into the phantom by varying its RR intervals. However, the sequence will still assume a constant RR interval of 1 second:</p><pre><code class="language-julia hljs">RRs = [900, 1100, 1000, 1000, 1000, 800] .* 1e-3</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.9
 1.1
 1.0
 1.0
 1.0
 0.8</code></pre><div class="admonition is-info" id="Note-ddbe442881ba9190"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ddbe442881ba9190" title="Permalink"></a></header><div class="admonition-body"><p>The <code>RRs</code> array contains <strong>scaling factors</strong> relative to the original duration of the phantom’s motion cycle.</p><p>In this example, the base duration of the cardiac motion is 1 second, which is defined within the <code>t</code> field of its <a href="../../explanation/3-phantom-format/#TimeCurve"><code>TimeCurve</code></a> structure. Consequently, the elements in <code>RRs</code> directly represent the actual RR intervals in seconds (e.g., 0.9 s, 1.1 s, etc.).</p></div></div><pre><code class="language-julia hljs"># Apply the new RRs to the phantom (both contraction and rotation):
obj.motion.motions[1].time.periods = RRs # Contraction (HeartBeat)
obj.motion.motions[2].time.periods = RRs # Rotation</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.9
 1.1
 1.0
 1.0
 1.0
 0.8</code></pre><p>Let’s visualize how the motion pattern has changed, now with variable-duration RR intervals:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/tut-6-phantom2.html&quot;</code></pre><center><object type="text/html" data="../../assets/tut-6-phantom2.html" style="width:90%; height:470px;"></object></center><p>Since the sequence still assumes a constant RR interval, it becomes unsynchronized with the phantom. This results in artifacts and temporal inconsistencies in the cine images. We will showcase these images in the next section.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.01060426 0.010269086 … 0.008025042 0.010592312; 0.010628335 0.010899059 … 0.0065182312 0.010640051; … ; 0.0070012347 0.007382395 … 0.006948803 0.007011889; 0.012010904 0.012000457 … 0.00610255 0.012029395]
 Float32[0.008625261 0.0064234645 … 0.005435613 0.00861725; 0.0028923415 0.007771121 … 0.0022181286 0.0028944784; … ; 0.009910286 0.0077981045 … 0.0066145607 0.009891878; 0.008789978 0.0034810123 … 0.009274362 0.008800577]
 Float32[0.004168158 0.0057311077 … 0.009752465 0.0041556866; 0.0028810897 0.0106289415 … 0.012475522 0.002883513; … ; 0.00932938 0.00869283 … 0.0047660465 0.009328846; 0.009687163 0.005157529 … 0.014191708 0.0096851755]
 Float32[0.010181431 0.010722554 … 0.0052860705 0.010201759; 0.012420936 0.013761634 … 0.011904957 0.012428335; … ; 0.0050122854 0.0062298286 … 0.004753678 0.005013555; 0.013206763 0.013093719 … 0.010333478 0.01322296]
 Float32[0.006105909 0.007770724 … 0.003540998 0.006115536; 0.011717836 0.013522086 … 0.009393374 0.011711556; … ; 0.002041224 0.0044699563 … 0.001945872 0.0020659985; 0.014308683 0.011535501 … 0.0068850494 0.014316177]
 Float32[0.0033085893 0.0052459724 … 0.010331396 0.0032872285; 0.0112006925 0.011757649 … 0.0072252415 0.011188291; … ; 0.0034226708 0.0029456487 … 0.0014199427 0.0034313772; 0.012323459 0.013178576 … 0.011626447 0.012329228]
 Float32[0.0048672985 0.0070429537 … 0.0047188643 0.004863366; 0.008695887 0.013050479 … 0.0063059353 0.008684744; … ; 0.00473862 0.0063805305 … 0.013164341 0.004757335; 0.013798731 0.008964906 … 0.008082261 0.013830145]
 Float32[0.005424939 0.013097052 … 0.013873591 0.00544106; 0.009241192 0.01191214 … 0.006996758 0.009280142; … ; 0.008145783 0.011006816 … 0.005573269 0.008163271; 0.011026671 0.008667146 … 0.010316359 0.010980729]
 Float32[0.0130124055 0.013472163 … 0.0032456156 0.013019738; 0.0019719694 0.0028832145 … 0.008276616 0.0019548708; … ; 0.0065108435 0.0040799887 … 0.007175982 0.0065224054; 0.0029562048 0.0034879872 … 0.003212826 0.0029449498]
 Float32[0.006992987 0.0077954903 … 0.010308142 0.007008475; 0.0070389053 0.004106071 … 0.0050283666 0.007006659; … ; 0.0041995985 0.0063637407 … 0.002136267 0.0042144503; 0.0059821922 0.0073283534 … 0.0057960656 0.0059780376]
 ⋮
 Float32[0.003547283 0.0050669224 … 0.008483986 0.003522415; 0.0075467527 0.00045222833 … 0.008711569 0.007562204; … ; 0.0055103456 0.00415651 … 0.0021693 0.0054944777; 0.0041253804 0.010574673 … 0.0067712483 0.004102449]
 Float32[0.0068332516 0.006715577 … 0.006017287 0.0068708938; 0.0078625195 0.00082492223 … 0.006556924 0.007855089; … ; 0.0077652014 0.0022352054 … 0.007628581 0.0077496306; 0.003160227 0.007677137 … 0.0041776686 0.0031402302]
 Float32[0.0067417147 0.0060430304 … 0.00026715803 0.0067469683; 0.006335221 0.0019362792 … 0.0033338533 0.0063415105; … ; 0.0043022716 0.0016585062 … 0.0060056015 0.004285926; 0.0027397953 0.0064026183 … 0.0044693663 0.0027382919]
 Float32[0.004743319 0.0059079383 … 0.0016247337 0.0047908872; 0.00468539 0.004057699 … 0.00290101 0.004681149; … ; 0.0008789329 0.0031012846 … 0.00073815347 0.00089077884; 0.0045399293 0.005007481 … 0.0049346285 0.004584958]
 Float32[0.0076658353 0.00897951 … 0.0031608301 0.007714907; 0.009113092 0.0052551595 … 0.0038233155 0.009146676; … ; 0.003493737 0.004750502 … 0.004197349 0.0035066404; 0.0075605367 0.010202206 … 0.00094943866 0.0076121907]
 Float32[0.014042839 0.012460056 … 0.016143078 0.014070747; 0.011497715 0.00909558 … 0.011750963 0.011518415; … ; 0.0022820714 0.005927585 … 0.004792157 0.0022684431; 0.01233055 0.011923331 … 0.009494058 0.012358644]
 Float32[0.013842699 0.012471137 … 0.015830416 0.013854901; 0.0127100535 0.008427085 … 0.011898693 0.012732117; … ; 0.0061611356 0.002989904 … 0.0037480718 0.006159703; 0.009847613 0.0133286975 … 0.011566197 0.009867044]
 Float32[0.005124456 0.0071802107 … 0.015870396 0.0051210467; 0.0055603115 0.008024974 … 0.009742919 0.005562087; … ; 0.0046909987 0.0018444734 … 0.003956446 0.004718169; 0.009092461 0.006636938 … 0.012596259 0.0090938695]
 Float32[0.002877757 0.0040803743 … 0.019465197 0.0028603284; 0.0081761675 0.003182783 … 0.013846828 0.008169648; … ; 0.0016664211 0.006119048 … 0.0011330452 0.001672231; 0.005308749 0.010441606 … 0.012524136 0.0052924487]</code></pre><h3 id="3.-Prospective-Triggering:-Resynchronized-Acquisition"><a class="docs-heading-anchor" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition">3. Prospective Triggering: Resynchronized Acquisition</a><a id="3.-Prospective-Triggering:-Resynchronized-Acquisition-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition" title="Permalink"></a></h3><p>To correct this, we synchronize the sequence <strong>manually</strong> by providing it the same RR intervals as the phantom:</p><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Sequence[ τ = 97000.0 ms | blocks: 24051 | ADC: 2000 | GR: 16000 | RF: 4000 | DEF: 5 ]</code></pre><p>This approach manually mimics cardiac triggering. The resulting cine is once again correctly aligned, despite the underlying arrhythmia.</p><p>In the future, this synchronization will be handled automatically through upcoming support for trigger extensions in the sequence framework.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.0012513535 0.00010388494 … 0.0016467368 0.0012786445; 0.0015652278 0.00012216758 … 0.0015663898 0.0015581243; … ; 0.00031856017 0.0016106422 … 0.0024461045 0.00032963997; 0.0001283718 0.001302438 … 0.0014793758 0.00014308705]
 Float32[0.0034882312 0.0026825948 … 0.009396663 0.0035487013; 0.00461368 0.0043486725 … 0.008791477 0.0046308558; … ; 0.0043045543 0.0037198518 … 0.005778321 0.0043274458; 0.0040216385 0.0037428488 … 0.009702174 0.004055239]
 Float32[0.0023054674 0.001500682 … 0.0017017656 0.0023189636; 0.0033864114 0.0043041343 … 0.0064002946 0.003405951; … ; 0.0061981385 0.008065051 … 0.013004502 0.006245277; 0.0043785907 0.003387331 … 0.007033423 0.0044203806]
 Float32[0.013328078 0.013117854 … 0.019107245 0.013390814; 0.008563686 0.011417441 … 0.016174093 0.008584396; … ; 0.004932018 0.004933387 … 0.005535621 0.0049211183; 0.011914897 0.008804796 … 0.013970671 0.011943703]
 Float32[0.006308116 0.00656966 … 0.00036907152 0.006304349; 0.009210627 0.012065342 … 0.015276522 0.0092113055; … ; 0.012529244 0.014702891 … 0.02246272 0.012550676; 0.011453211 0.0094003435 … 0.01531875 0.011478201]
 Float32[0.015687957 0.016221939 … 0.024931973 0.01569989; 0.008789233 0.014566536 … 0.019166296 0.008791406; … ; 0.0031672504 0.004621321 … 0.008344029 0.0031823367; 0.014188543 0.01026594 … 0.014335862 0.014193247]
 Float32[0.008782822 0.00966802 … 0.012747029 0.0087766275; 0.014016059 0.019191088 … 0.018454924 0.01401937; … ; 0.018169748 0.02027946 … 0.015816351 0.018195456; 0.017698906 0.013609807 … 0.01547714 0.017690014]
 Float32[0.019615911 0.023003856 … 0.016077142 0.019642534; 0.0065529067 0.020907156 … 0.013592752 0.006575449; … ; 0.014165114 0.0146791795 … 0.016265448 0.01416794; 0.020989133 0.008547259 … 0.00515268 0.021009764]
 Float32[0.010277731 0.0130867055 … 0.009992405 0.010314044; 0.0057693385 0.019676838 … 0.02296989 0.0057888655; … ; 0.01540879 0.015068138 … 0.012408996 0.015434156; 0.020131797 0.0062160892 … 0.012733198 0.020121241]
 Float32[0.01737552 0.0145666525 … 0.017751034 0.017345728; 0.0066947243 0.0094537875 … 0.012671932 0.0066798804; … ; 0.00888922 0.007990776 … 0.014030809 0.008900285; 0.011715372 0.0065376335 … 0.019475473 0.011715644]
 ⋮
 Float32[0.021842485 0.021921305 … 0.027796404 0.02184417; 0.016511181 0.015891861 … 0.022642357 0.016517181; … ; 0.0034377456 0.0025836132 … 0.00081550353 0.0034378064; 0.016663345 0.01716178 … 0.019904038 0.016680297]
 Float32[0.01812828 0.01831619 … 0.02098637 0.018149825; 0.014731618 0.014522458 … 0.018857962 0.014746946; … ; 0.0048264475 0.0039019915 … 0.0068106633 0.004830345; 0.015112459 0.0149851795 … 0.01872662 0.015118998]
 Float32[0.013230768 0.013753776 … 0.011485113 0.013236878; 0.012185497 0.011545217 … 0.013072975 0.0121976575; … ; 0.007212229 0.0066279145 … 0.0086043095 0.007207544; 0.01211489 0.012558149 … 0.012058079 0.0121249175]
 Float32[0.0048385076 0.0054004136 … 0.003918642 0.0048463307; 0.0067116464 0.005871628 … 0.0047285575 0.0067168316; … ; 0.0073580295 0.0064334227 … 0.011581558 0.0073663066; 0.006187082 0.0066318065 … 0.008164446 0.0062024337]
 Float32[0.0025043217 0.0017322573 … 0.01142196 0.002515181; 0.005059458 0.0008631112 … 0.0042022234 0.005068067; … ; 0.007061488 0.0068023084 … 0.009350189 0.007075195; 0.0014188921 0.004108747 … 0.008031414 0.0014234919]
 Float32[0.0097876415 0.009130883 … 0.018355848 0.009815937; 0.0075741853 0.005336744 … 0.012291989 0.007589602; … ; 0.005341055 0.0048603914 … 0.007783133 0.0053506573; 0.0050965324 0.006557656 … 0.013065749 0.005119334]
 Float32[0.013578847 0.012773406 … 0.023251403 0.013606163; 0.010709832 0.009079154 … 0.01762072 0.010740555; … ; 0.003069022 0.0037018242 … 0.0028811272 0.0030720262; 0.008920666 0.009580831 … 0.018473005 0.008932123]
 Float32[0.016108394 0.015666643 … 0.023365598 0.016133923; 0.012948401 0.011784478 … 0.020310303 0.012959241; … ; 0.002690287 0.0020211292 … 0.0026334373 0.0026817205; 0.011543742 0.012328867 … 0.01964405 0.01155899]
 Float32[0.015944289 0.015421405 … 0.020623552 0.015955579; 0.013183819 0.012188134 … 0.019178223 0.013198531; … ; 0.0042210952 0.003089121 … 0.006170036 0.004219773; 0.012166572 0.012873253 … 0.019153565 0.01217658]</code></pre><p>Below, we compare the results of the desynchronized 👎 acquisition simulated in the previous section with the resynchronized 🕐 acquisition:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames_comparison.gif</code></pre><center><object data="../../assets/tut-7-frames_comparison.gif" style="width:90%"></object></center><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../06-DiffusionMotion/">« Diffusion-induced Signal Attenuation</a><a class="docs-footer-nextpage" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Friday 13 June 2025 00:02">Friday 13 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
