<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Cardiac Cine MRI with Arrhythmias · KomaMRI.jl</title><meta name="title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta property="og:title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta property="twitter:title" content="Cardiac Cine MRI with Arrhythmias · KomaMRI.jl"/><meta name="description" content="Documentation for KomaMRI.jl."/><meta property="og:description" content="Documentation for KomaMRI.jl."/><meta property="twitter:description" content="Documentation for KomaMRI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/hide-documenter-example-output.css" rel="stylesheet" type="text/css"/><link href="../../assets/center-images.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="KomaMRI.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="KomaMRI.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">🏠 Home</a></li><li><a class="tocitem" href="../../how-to/1-getting-started/">🏃 Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">🏋️ Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01-FID/">Free Induction Decay</a></li><li><a class="tocitem" href="../02-SmallTipApproximation/">Small Tip Angle Approximation</a></li><li><a class="tocitem" href="../03-ChemicalShiftEPI/">Chemical Shift in an EPI sequence</a></li><li><a class="tocitem" href="../04-3DSliceSelective/">Slice-Selective Acquisition of 3D Phantom</a></li><li><a class="tocitem" href="../05-SimpleMotion/">Patient&#39;s Motion During Acquisition</a></li><li><a class="tocitem" href="../06-DiffusionMotion/">Diffusion-induced Signal Attenuation</a></li><li class="is-active"><a class="tocitem" href>Cardiac Cine MRI with Arrhythmias</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">🧑‍🔬 Reproducible Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences</a></li><li><a class="tocitem" href="../../tutorial-pluto/02-low-field-cmra-optimization/">Low-Field CMRA Optimization</a></li><li><a class="tocitem" href="../../tutorial-pluto/03-low-field-boost-optimization/">Low-Field BOOST Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">👨‍🍳 How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how-to/2-1-use-koma-ui/">Use Koma&#39;s User Interface</a></li><li><a class="tocitem" href="../../how-to/2-2-use-koma-notebooks/">Use Koma in Notebooks</a></li><li><a class="tocitem" href="../../how-to/2-3-use-koma-scripts/">Use Koma in Julia Scripts</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-phantom/">Create Your Own Phantom</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-sequence/">Create Your Own Sequence</a></li><li><a class="tocitem" href="../../how-to/4-run-distributed-simulations/">Run Distributed Simulations</a></li><li><a class="tocitem" href="../../how-to/5-contribute-to-koma/">Contribute to Koma</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">🤔 Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanation/1-phantom/">Phantom</a></li><li><a class="tocitem" href="../../explanation/2-motion/">Motion</a></li><li><a class="tocitem" href="../../explanation/3-phantom-format/">Phantom File Format</a></li><li><a class="tocitem" href="../../explanation/4-sequence/">Sequence</a></li><li><a class="tocitem" href="../../explanation/5-seq-events/">Sequence Events</a></li><li><a class="tocitem" href="../../explanation/6-simulation/">Simulation</a></li><li><a class="tocitem" href="../../explanation/7-gpu-explanation/">GPU Parallelization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">👨‍💻 Reference Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/1-api/">API Overview</a></li><li><a class="tocitem" href="../../reference/2-koma-base/">KomaMRIBase</a></li><li><a class="tocitem" href="../../reference/3-koma-core/">KomaMRICore</a></li><li><a class="tocitem" href="../../reference/4-koma-files/">KomaMRIFiles</a></li><li><a class="tocitem" href="../../reference/5-koma-plots/">KomaMRIPlots</a></li><li><a class="tocitem" href="../../reference/6-koma-mri/">KomaMRI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">🏋️ Tutorials</a></li><li class="is-active"><a href>Cardiac Cine MRI with Arrhythmias</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Cardiac Cine MRI with Arrhythmias</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl/blob/master/docs/src/tutorial/lit-07-RRVariability.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Cardiac-Cine-MRI-with-Arrhythmias"><a class="docs-heading-anchor" href="#Cardiac-Cine-MRI-with-Arrhythmias">Cardiac Cine MRI with Arrhythmias</a><a id="Cardiac-Cine-MRI-with-Arrhythmias-1"></a><a class="docs-heading-anchor-permalink" href="#Cardiac-Cine-MRI-with-Arrhythmias" title="Permalink"></a></h1><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Scanner
  B0: Float64 1.5
  B1: Float64 1.0e-5
  Gmax: Float64 0.06
  Smax: Int64 500
  ADC_Δt: Float64 2.0e-6
  seq_Δt: Float64 1.0e-5
  GR_Δt: Float64 1.0e-5
  RF_Δt: Float64 1.0e-6
  RF_ring_down_T: Float64 2.0e-5
  RF_dead_time_T: Float64 0.0001
  ADC_dead_time_T: Float64 1.0e-5
</code></pre><p><a href="../07-RRVariability.jl"><img src="https://img.shields.io/badge/julia-script-9558B2?logo=julia" alt/></a> <a href="../07-RRVariability.ipynb"><img src="https://img.shields.io/badge/jupyter-notebook-blue?logo=jupyter" alt/></a> <a href="https://mybinder.org/v2/gh/JuliaHealth/KomaMRI.jl/master?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FJuliaHealth%252FKomaMRI.jl%26urlpath%3Dlab%252Ftree%252FKomaMRI.jl%252Fdev%252Ftutorial%252F07-RRVariability.ipynb%26branch%3Dgh-pages"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><p>This tutorial shows how to simulate cardiac cine MRI using Koma, including cases with variable RR intervals (i.e., arrhythmias). You&#39;ll learn how to:</p><ol><li>Simulate a clean cine acquisition with constant RR intervals.</li><li>Introduce arrhythmias (variable RR intervals) into the cardiac phantom.</li><li>Observe how this desynchronization degrades image quality.</li><li>Correct the acquisition by synchronizing the sequence with the phantom’s RR variability (manual triggering).</li></ol><h3 id="1.-Constant-RR-for-Phantom-and-Sequence"><a class="docs-heading-anchor" href="#1.-Constant-RR-for-Phantom-and-Sequence">1. Constant RR for Phantom and Sequence</a><a id="1.-Constant-RR-for-Phantom-and-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Constant-RR-for-Phantom-and-Sequence" title="Permalink"></a></h3><p>We will begin by simulating a cardiac cine on a myocardial phantom with a constant RR interval. We&#39;ll use the <code>heart_phantom</code> function to create a ring-shaped phantom filled with blood, resembling the left ventricle:</p><pre><code class="language-julia hljs">obj = heart_phantom()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phantom{Float64}
  name: String &quot;LeftVentricle&quot;
  x: Array{Float64}((12714,)) [-0.007573593128807149, -0.006866486347620604, -0.006159379566434059, -0.005452272785247507, -0.004745166004060962, -0.004038059222874417, -0.003330952441687865, -0.00262384566050132, -0.001916738879314775, -0.001209632098128223  …  -0.001916738879314775, -0.001209632098128223, -0.000502525316941678, 0.000204581464244874, 0.000911688245431419, 0.001618795026617964, 0.002325901807804516, 0.003033008588991061, 0.003740115370177606, 0.004447222151364158]
  y: Array{Float64}((12714,)) [-0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762  …  0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736]
  z: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  ρ: Array{Float64}((12714,)) [0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9  …  0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
  T1: Array{Float64}((12714,)) [1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026  …  1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026]
  T2: Array{Float64}((12714,)) [0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042  …  0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042]
  T2s: Array{Float64}((12714,)) [1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6  …  1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6]
  Δw: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((12714,)) [2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9  …  2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9]
  Dλ2: Array{Float64}((12714,)) [1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10  …  1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10]
  Dθ: Array{Float64}((12714,)) [-0.16916284697591719, -0.1536287198547715, -0.1380195046747176, -0.12234231369025762, -0.10660445476529863, -0.090813412529144, -0.07497682827307205, -0.05910247871255467, -0.0431982537552276, -0.02727213342817287  …  -3.0987888698389616, -3.114569742820848, -3.130364088806849, 3.137021268443483, 3.121223600397341, 3.1054360932317397, 3.0896665955717584, 3.0739229023532744, 3.058212731905059, 3.0425437035966953]
  motion: MotionList{Float64}
</code></pre><p>By default, this phantom exhibits periodic contraction and rotation with a 1-second period:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/tut-6-phantom1.html&quot;</code></pre><center><object type="text/html" data="../../assets/tut-6-phantom1.html" style="width:90%; height:470px;"></object></center><p>As shown in previous tutorials, the phantom&#39;s motion is defined by its <code>motion</code> field. Until now, this motion has typically consisted of a single <code>Motion</code> component. In this case, however, it consists of two independent motions: a contraction (<code>HeartBeat</code>) and a <code>Rotation</code>. These two are grouped together in a <code>MotionList</code> structure:</p><pre><code class="language-julia-repl hljs">julia&gt; obj.motion
MotionList{Float64}(Motion{Float64}[Motion{Float64}
  action: HeartBeat{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
, Motion{Float64}
  action: Rotate{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
])</code></pre><p>Now, we will create a bSSFP cine sequence with the following parameters:</p><pre><code class="language-julia hljs">RRs          = [1.0]       # [s] constant RR interval
N_matrix     = 50          # image size = N x N
N_phases     = 30          # Number of cardiac phases
FOV          = 0.11        # [m]
TR           = 25e-3       # [s]
flip_angle   = 10          # [º]
adc_duration = 0.2e-3      # [s]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0002</code></pre><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30-element Vector{Any}:
 Float32[0.00027948897 0.00035774038 … 0.00027403762 0.00028051372; 0.000603628 0.0006142815 … 0.0005830656 0.00059127883; … ; 0.00084906403 0.00082567084 … 0.00087111385 0.000829205; 0.000563354 0.0005170669 … 0.00065657985 0.0005495703]
 Float32[0.00020032868 6.6721776f-5 … 0.00030545495 0.00017371618; 0.00030148707 0.00044404322 … 0.00026181995 0.00030583027; … ; 0.00043222864 0.00050730834 … 0.00048955606 0.00044685023; 0.0005117418 0.0003245458 … 0.00069349015 0.00048766422]
 Float32[0.0004364992 0.00046129414 … 0.00040104208 0.00042627362; 0.0006120736 0.0007605959 … 0.0005567828 0.00062489574; … ; 0.00055329094 0.00069163245 … 0.0005814148 0.0006132175; 0.0005448776 0.00035736593 … 0.0007303612 0.00052744115]
 Float32[0.0002921217 0.00037791065 … 0.00033161064 0.0003306951; 0.0005085232 0.000665028 … 0.0004544546 0.00053169345; … ; 0.00060083834 0.0007425273 … 0.00063843455 0.0006399606; 0.00070351956 0.00063405524 … 0.00086573587 0.0007289938]
 Float32[0.00051172107 0.0006345885 … 0.00048818378 0.00056078983; 0.0006017951 0.00072692236 … 0.0005583805 0.00060350477; … ; 0.0006950257 0.0007493684 … 0.00072638097 0.000701329; 0.0008372876 0.0007520783 … 0.0009992374 0.0008655703]
 Float32[0.0010284857 0.0011256023 … 0.0010095554 0.001065268; 0.0008556431 0.00096141204 … 0.0007848815 0.00085271953; … ; 0.0008926509 0.0008850348 … 0.00085405825 0.00083683355; 0.00094103755 0.0008822944 … 0.0011183774 0.00099409]
 Float32[0.0012826797 0.0014000647 … 0.0012611543 0.001318828; 0.0008721667 0.00093215535 … 0.0007463283 0.0008059851; … ; 0.000783074 0.00081591273 … 0.00074285053 0.0007429407; 0.0010366333 0.0009245728 … 0.0011127342 0.0010118745]
 Float32[0.0012341778 0.0012913167 … 0.0011556125 0.0012053811; 0.0007675791 0.00077793805 … 0.00071822805 0.0007184198; … ; 0.0006997643 0.00071307103 … 0.0007081966 0.000688458; 0.0010176883 0.0009810292 … 0.0010768918 0.0010131462]
 Float32[0.0016208238 0.0016503214 … 0.0016089773 0.001604786; 0.0008086928 0.00085358333 … 0.0007638787 0.000813641; … ; 0.00024615752 0.00026996556 … 0.0001982376 0.00023438392; 0.0010385207 0.0010640324 … 0.0010681355 0.0010676796]
 Float32[0.0005469399 0.00059013977 … 0.0004914011 0.00053074496; 0.00032834077 0.000324229 … 0.00031425312 0.0002946765; … ; 0.00026255767 0.00027010217 … 0.00026323032 0.00025673394; 0.00037048096 0.00035151627 … 0.00036470615 0.00033851113]
 ⋮
 Float32[0.00096408714 0.0008636815 … 0.00097016257 0.0008875414; 0.00050357817 0.00048570757 … 0.00048402662 0.00047699275; … ; 0.00023834941 0.00027022752 … 0.00023836864 0.00026407876; 0.00052065065 0.00046507016 … 0.00055298535 0.0005051764]
 Float32[0.00031962647 0.00040770735 … 0.0003426961 0.00037429787; 0.00030416067 0.00034507297 … 0.0003107508 0.00032682624; … ; 0.0002994139 0.00030266267 … 0.0002939503 0.0002953049; 0.00024757627 0.00026778 … 0.00027462636 0.00025966877]
 Float32[0.0013934394 0.0014387293 … 0.0014663321 0.0014334092; 0.00080231053 0.00081084296 … 0.00086629664 0.0008285602; … ; 0.00043768482 0.00040987972 … 0.00047868182 0.0004389121; 0.0006805904 0.0007204787 … 0.0006872903 0.0006999278]
 Float32[0.0018013432 0.0017993877 … 0.0018663534 0.0018102566; 0.00092955993 0.00096960727 … 0.0009483735 0.00095575285; … ; 0.0004129332 0.00040656133 … 0.00039848065 0.00038738002; 0.0009108564 0.0009007851 … 0.0009795488 0.000930347]
 Float32[0.0013480971 0.0012798252 … 0.0013872315 0.0013095437; 0.0006246003 0.00059749663 … 0.0006438641 0.00061498245; … ; 0.00024918528 0.00023445135 … 0.0002609488 0.00024047759; 0.0007284402 0.00072093913 … 0.00076024886 0.0007256523]
 Float32[0.00025055453 0.0001631366 … 0.00022396549 0.0001725577; 0.0001898811 0.00019497934 … 0.00020715872 0.0001923982; … ; 0.0002543043 0.00025655807 … 0.0002838324 0.0002631743; 0.00028391948 0.00025065726 … 0.00029420637 0.0002723503]
 Float32[0.00088855275 0.0009370102 … 0.0009468818 0.0009499109; 0.0005505464 0.0006132453 … 0.0005992381 0.00060481747; … ; 0.0003237126 0.0003535846 … 0.00032923956 0.00034823004; 0.00046755903 0.0004986646 … 0.000522135 0.0005164361]
 Float32[0.0014975441 0.001539503 … 0.0015964981 0.0015534995; 0.00073830644 0.0007786099 … 0.0007941466 0.000786469; … ; 0.00027611485 0.0002889205 … 0.00028340795 0.0002781381; 0.0008252776 0.0008471591 … 0.0008956102 0.0008680771]
 Float32[0.0012640327 0.001293706 … 0.001321897 0.0012993814; 0.00051425607 0.0005632227 … 0.00052147434 0.0005402626; … ; 0.00017343729 0.0002019305 … 0.00016314146 0.00018190696; 0.0007473321 0.0007303227 … 0.0008284595 0.00077520363]</code></pre><p>The simulation and subsequent reconstruction produces the following cine frames, which look clean and temporally coherent:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames1.gif</code></pre><center><object data="../../assets/tut-7-frames1.gif" style="height:375px"></object></center><h3 id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence"><a class="docs-heading-anchor" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence">2. Arrhythmic Phantom: Variable RR, Constant Sequence</a><a id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence" title="Permalink"></a></h3><p>Now, we will introduce arrhythmias into the phantom by varying its RR intervals. However, the sequence will still assume a constant RR interval of 1 second.</p><pre><code class="language-julia hljs">RRs = [900, 1100, 1000, 1000, 1000, 800] .* 1e-3</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.9
 1.1
 1.0
 1.0
 1.0
 0.8</code></pre><div class="admonition is-info" id="Note-ddbe442881ba9190"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ddbe442881ba9190" title="Permalink"></a></header><div class="admonition-body"><p>The <code>RRs</code> array contains <strong>scaling factors</strong> relative to the original duration of the phantom’s motion cycle.</p><p>In this example, the base duration of the cardiac motion is 1 second, which is defined within the <code>t</code> field of its <a href="../../explanation/3-phantom-format/#TimeCurve"><code>TimeCurve</code></a> structure. Consequently, the elements in <code>RRs</code> directly represent the actual RR intervals in seconds (e.g., 0.9 s, 1.1 s, etc.).</p></div></div><p>Let&#39;s apply the new <code>RRs</code> to the phantom:</p><pre><code class="language-julia hljs"># Take the time curve from the contraction motion:
t_curve = obj.motion.motions[1].time
# Generate a new time curve:
t_curve_new = TimeCurve(
    t = t_curve.t,
    t_unit = t_curve.t_unit,
    periodic = true,
    periods = RRs
)
# Assign the new time curve to both the contraction and the rotation:
obj.motion.motions[1].time = obj.motion.motions[2].time = t_curve_new</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TimeCurve{Float64}
  t: Array{Float64}((3,)) [0.0, 0.2, 1.0]
  t_unit: Array{Float64}((3,)) [0.0, 1.0, 0.0]
  periodic: Bool true
  periods: Array{Float64}((6,)) [0.9, 1.1, 1.0, 1.0, 1.0, 0.8]
  t_start: Float64 0.0
  t_end: Float64 1.0
</code></pre><p>Let’s visualize how the motion pattern has changed, now with variable-duration RR intervals:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/tut-6-phantom2.html&quot;</code></pre><center><object type="text/html" data="../../assets/tut-6-phantom2.html" style="width:90%; height:470px;"></object></center><p>Since the sequence still assumes a constant RR interval, it becomes unsynchronized with the phantom. This results in artifacts and temporal inconsistencies in the cine images. We will showcase these images in the next section.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30-element Vector{Any}:
 Float32[0.009713727 0.008997305 … 0.008275012 0.009694573; 0.009352812 0.009625462 … 0.0063931243 0.009366928; … ; 0.00757415 0.008049894 … 0.0058083385 0.0075758346; 0.010593997 0.010597869 … 0.005239466 0.010593903]
 Float32[0.0066860057 0.005276601 … 0.0048446655 0.006645529; 0.0014413926 0.008190471 … 0.004743345 0.0014319571; … ; 0.011457457 0.009182585 … 0.009828418 0.011449907; 0.007823481 0.0030801424 … 0.012520953 0.007827817]
 Float32[0.0071437187 0.00862867 … 0.0069651534 0.0071372073; 0.006109373 0.013280635 … 0.014797523 0.0061177122; … ; 0.007331674 0.008820555 … 0.0061490135 0.0073446007; 0.012463865 0.008289132 … 0.011965694 0.012474635]
 Float32[0.007450989 0.007958523 … 0.0013720843 0.0074415975; 0.013630954 0.012908756 … 0.008405652 0.013623933; … ; 0.001439476 0.004091228 … 0.001767345 0.0014578695; 0.013747169 0.0132313855 … 0.0058025457 0.013761063]
 Float32[0.00289577 0.004786815 … 0.01013283 0.0028963606; 0.009235187 0.011701381 … 0.005268919 0.009221873; … ; 0.004605374 0.0018446015 … 0.0015925069 0.004620275; 0.0121903485 0.010766359 … 0.010932989 0.012204083]
 Float32[0.003906017 0.00998872 … 0.0071548615 0.003927226; 0.0081981905 0.013213169 … 0.009509876 0.00822705; … ; 0.00809757 0.011489753 … 0.016785854 0.008104731; 0.0123525625 0.0077541512 … 0.011513138 0.012338038]
 Float32[0.009245188 0.0134932455 … 0.0069882134 0.009235627; 0.005593865 0.008365157 … 0.006845802 0.0056151063; … ; 0.0073071625 0.008019165 … 0.006257672 0.007328299; 0.00808176 0.005343557 … 0.005715549 0.008072892]
 Float32[0.008301961 0.0083771935 … 0.010808902 0.008320483; 0.009134901 0.0057508564 … 0.0064359843 0.00910847; … ; 0.0068404484 0.008343413 … 0.0012247289 0.006848758; 0.0067246924 0.008855768 … 0.0061228843 0.006744533]
 Float32[0.010522951 0.008725488 … 0.0030345113 0.010553836; 0.0046875994 0.0060795317 … 0.0026331267 0.0046748216; … ; 0.007415319 0.006346545 … 0.002206019 0.0074272603; 0.006966914 0.0053529814 … 0.0035193076 0.006961349]
 Float32[0.004545238 0.008901156 … 0.009504679 0.0045890426; 0.001861301 0.0067875586 … 0.00041186737 0.0018723557; … ; 0.00041513264 0.0018397742 … 0.004671993 0.00044007142; 0.0059097856 0.0033043195 … 0.0062857172 0.0059218425]
 ⋮
 Float32[0.012393804 0.014796191 … 0.011054894 0.012401846; 0.010015732 0.011511058 … 0.0067333565 0.010020793; … ; 0.008650263 0.0045550144 … 0.005544618 0.008679452; 0.012461893 0.011409084 … 0.012677372 0.012490243]
 Float32[0.011933858 0.014527066 … 0.0041377954 0.011916635; 0.01208129 0.011053595 … 0.012607919 0.0121047655; … ; 0.006488117 0.008619834 … 0.011828949 0.0064771376; 0.010181443 0.013739267 … 0.0020031584 0.010213365]
 Float32[0.010901749 0.011250162 … 0.0018931424 0.010898361; 0.008090961 0.007938145 … 0.003039036 0.008086394; … ; 0.0018596989 0.0040292325 … 0.007310617 0.0018341955; 0.011068362 0.011048889 … 0.010988342 0.011086732]
 Float32[0.0031076395 0.008108168 … 0.007699087 0.0030940573; 0.005181259 0.008210644 … 0.007856841 0.005207965; … ; 0.00409518 0.0029942617 … 0.002678617 0.004093612; 0.0085401535 0.007485889 … 0.009268183 0.008525015]
 Float32[0.004321126 0.008860096 … 0.008261719 0.004322898; 0.0075044073 0.002292206 … 0.0065011345 0.0075125205; … ; 0.007717143 0.0038679452 … 0.004539539 0.007686454; 0.0039996747 0.009489662 … 0.005251159 0.0040219687]
 Float32[0.006953714 0.004072482 … 0.0035444358 0.006945232; 0.007570137 0.0016400442 … 0.0053372514 0.0075684045; … ; 0.007010826 0.0036692957 … 0.0077631506 0.0070070047; 0.001964035 0.0073851137 … 0.004452778 0.0019335301]
 Float32[0.004916662 0.0072298637 … 0.0023035465 0.004947627; 0.0054568 0.004033448 … 0.0022053625 0.0054728007; … ; 0.0017478075 0.0023405168 … 0.0015601359 0.0017622173; 0.0047842734 0.005661626 … 0.0052970257 0.0047990875]
 Float32[0.007906903 0.008367758 … 0.00440851 0.007964023; 0.00842962 0.0047196327 … 0.002513342 0.00844986; … ; 0.0032774021 0.0057140565 … 0.0047555976 0.0032635843; 0.0071609896 0.009648854 … 0.0026326133 0.0072072144]
 Float32[0.014114064 0.0117878495 … 0.016942143 0.014128508; 0.011126945 0.00854615 … 0.01322428 0.011162612; … ; 0.0023260086 0.0052538584 … 0.0065500475 0.0023122083; 0.011147127 0.011624915 … 0.010033794 0.011148855]</code></pre><h3 id="3.-Prospective-Triggering:-Resynchronized-Acquisition"><a class="docs-heading-anchor" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition">3. Prospective Triggering: Resynchronized Acquisition</a><a id="3.-Prospective-Triggering:-Resynchronized-Acquisition-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition" title="Permalink"></a></h3><p>To correct this, we synchronize the sequence <strong>manually</strong> by providing it the same RR intervals as the phantom:</p><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Sequence[ τ = 97600.0 ms | blocks: 21051 | ADC: 1500 | GR: 12000 | RF: 3500 | DEF: 5 ]</code></pre><p>This approach manually mimics cardiac triggering. The resulting cine is once again correctly aligned, despite the underlying arrhythmia.</p><p>In the future, this synchronization will be handled automatically through upcoming support for trigger extensions in the sequence framework.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">30-element Vector{Any}:
 Float32[0.0010705598 0.0004903932 … 0.0013510778 0.0010868532; 0.0014529374 0.00019814169 … 0.0016696198 0.0014540411; … ; 0.0009440236 0.0012297351 … 0.0020727224 0.00095141854; 0.00033952983 0.0012199022 … 0.0014981545 0.0003672403]
 Float32[0.0019429297 0.0010774174 … 0.0031499348 0.0019876275; 0.0015053013 0.0016366896 … 0.0021039473 0.0015026503; … ; 0.0014456811 0.0018395515 … 0.00063257007 0.0014670674; 0.0016925859 0.0012407403 … 0.0027514247 0.0017415857]
 Float32[0.0030454767 0.0024316597 … 0.0037602938 0.0030854428; 0.0029536276 0.0035333538 … 0.0057779104 0.0029681018; … ; 0.0033351968 0.004264007 … 0.0063633546 0.00338536; 0.0036629501 0.0032010137 … 0.0059747184 0.0037084122]
 Float32[0.0032657783 0.0017020117 … 0.0042966027 0.0032623177; 0.002948699 0.0055403006 … 0.0064031957 0.0029381288; … ; 0.005794017 0.0068769585 … 0.010021697 0.0058157486; 0.0055978848 0.0031958814 … 0.004497882 0.005628964]
 Float32[0.0065495083 0.0068768384 … 0.012000113 0.006593056; 0.00203895 0.008466232 … 0.010301263 0.002049902; … ; 0.0049443557 0.0055232076 … 0.0056911865 0.004951056; 0.008617947 0.0025110745 … 0.005030366 0.0086348625]
 Float32[0.0066878223 0.0076961247 … 0.010342109 0.0066978135; 0.00671399 0.0119205145 … 0.013672349 0.0067536924; … ; 0.009424832 0.010960528 … 0.0110399965 0.009470909; 0.011316108 0.0072191698 … 0.010222796 0.011329896]
 Float32[0.0063083014 0.008934395 … 0.004106847 0.0062575573; 0.0070718382 0.013592263 … 0.012951676 0.007101065; … ; 0.014588958 0.0146002285 … 0.019066853 0.014632034; 0.012649625 0.006408403 … 0.00805439 0.01267047]
 Float32[0.017284337 0.021280441 … 0.0073449872 0.017339515; 0.009693225 0.020711485 … 0.017918054 0.00970913; … ; 0.016090376 0.014903559 … 0.019072518 0.01610851; 0.021365019 0.011565988 … 0.002070647 0.02136015]
 Float32[0.018304294 0.020597538 … 0.003751181 0.018314166; 0.0077037313 0.015901802 … 0.012070375 0.007692177; … ; 0.0047450094 0.008601276 … 0.005764036 0.004724291; 0.017741524 0.011381319 … 0.0007227801 0.01774022]
 Float32[0.00032258988 0.00066124933 … 0.0072400663 0.00030533082; 0.003351548 0.0012014525 … 0.0014273018 0.0033301874; … ; 0.003313097 0.003285368 … 0.003932342 0.0033091314; 0.0020405916 0.0014288505 … 0.009412419 0.0020630967]
 ⋮
 Float32[0.008002307 0.008804292 … 0.012785947 0.00798404; 0.0061131143 0.008419441 … 0.012517431 0.006085335; … ; 0.0033374869 0.0026628997 … 0.0034228726 0.0033386643; 0.008014501 0.0065858103 … 0.009573023 0.007988082]
 Float32[0.0028190054 0.0031955428 … 0.0037688082 0.0027951114; 0.0033005578 0.0047170995 … 0.006566052 0.003266194; … ; 0.0038687664 0.0036012998 … 0.0068361615 0.0038593106; 0.0043476205 0.00339461 … 0.0066911257 0.0043131774]
 Float32[0.0032737746 0.003173333 … 0.0061639724 0.003270794; 0.0011460971 0.002855072 … 0.003559203 0.0011672112; … ; 0.0040409053 0.0034017677 … 0.0071302364 0.00402082; 0.002857275 0.0013493224 … 0.0032207593 0.0028699737]
 Float32[0.008287678 0.008352959 … 0.015812358 0.0082727475; 0.004382804 0.0055423444 … 0.010229448 0.0043784725; … ; 0.0024470673 0.0027440295 … 0.0075500133 0.002437909; 0.0060618916 0.0048751747 … 0.007622547 0.0060606324]
 Float32[0.010885373 0.011186451 … 0.020665491 0.010841872; 0.007398259 0.008138546 … 0.014514804 0.0073902137; … ; 0.00094727613 0.001013529 … 0.003242962 0.0009397075; 0.008207516 0.007611908 … 0.013628144 0.008191269]
 Float32[0.011601666 0.011670183 … 0.02046341 0.011539952; 0.008139979 0.009494138 … 0.017018022 0.008104176; … ; 0.0021435185 0.0013713046 … 0.0019583832 0.002143492; 0.009969115 0.008610595 … 0.014270652 0.009943552]
 Float32[0.008616227 0.008850907 … 0.014188314 0.008590767; 0.00729994 0.00832278 … 0.013801069 0.007291972; … ; 0.003744256 0.0032202208 … 0.0062268614 0.0037255194; 0.008228974 0.0072205556 … 0.013167878 0.008222641]
 Float32[0.0047592027 0.0045649963 … 0.0041296734 0.004734638; 0.0041857003 0.0056327414 … 0.008307548 0.004166505; … ; 0.005184716 0.004162435 … 0.008704514 0.0051794304; 0.0060428707 0.004439053 … 0.006977423 0.006032081]
 Float32[0.00278042 0.0022313457 … 0.0070945923 0.0027683277; 0.00046779195 0.0029928323 … 0.0038080823 0.0004661186; … ; 0.005011725 0.004235506 … 0.010056181 0.005002039; 0.0030987922 0.000517397 … 0.0033318887 0.003100964]</code></pre><p>Below, we compare the results of the desynchronized 👎 acquisition simulated in the previous section with the resynchronized 🕐 acquisition:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames_comparison.gif</code></pre><center><object data="../../assets/tut-7-frames_comparison.gif" style="width:100%"></object></center><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../06-DiffusionMotion/">« Diffusion-induced Signal Attenuation</a><a class="docs-footer-nextpage" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Friday 13 June 2025 11:52">Friday 13 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
