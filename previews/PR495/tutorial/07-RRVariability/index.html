<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Arrhythmic Cardiac Cine MRI · KomaMRI.jl</title><meta name="title" content="Arrhythmic Cardiac Cine MRI · KomaMRI.jl"/><meta property="og:title" content="Arrhythmic Cardiac Cine MRI · KomaMRI.jl"/><meta property="twitter:title" content="Arrhythmic Cardiac Cine MRI · KomaMRI.jl"/><meta name="description" content="Documentation for KomaMRI.jl."/><meta property="og:description" content="Documentation for KomaMRI.jl."/><meta property="twitter:description" content="Documentation for KomaMRI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/hide-documenter-example-output.css" rel="stylesheet" type="text/css"/><link href="../../assets/center-images.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="KomaMRI.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="KomaMRI.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">🏠 Home</a></li><li><a class="tocitem" href="../../how-to/1-getting-started/">🏃 Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">🏋️ Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../01-FID/">Free Induction Decay</a></li><li><a class="tocitem" href="../02-SmallTipApproximation/">Small Tip Angle Approximation</a></li><li><a class="tocitem" href="../03-ChemicalShiftEPI/">Chemical Shift in an EPI sequence</a></li><li><a class="tocitem" href="../04-3DSliceSelective/">Slice-Selective Acquisition of 3D Phantom</a></li><li><a class="tocitem" href="../05-SimpleMotion/">Patient&#39;s Motion During Acquisition</a></li><li><a class="tocitem" href="../06-DiffusionMotion/">Diffusion-induced Signal Attenuation</a></li><li class="is-active"><a class="tocitem" href>Arrhythmic Cardiac Cine MRI</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">🧑‍🔬 Reproducible Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences</a></li><li><a class="tocitem" href="../../tutorial-pluto/02-low-field-cmra-optimization/">Low-Field CMRA Optimization</a></li><li><a class="tocitem" href="../../tutorial-pluto/03-low-field-boost-optimization/">Low-Field BOOST Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">👨‍🍳 How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how-to/2-1-use-koma-ui/">Use Koma&#39;s User Interface</a></li><li><a class="tocitem" href="../../how-to/2-2-use-koma-notebooks/">Use Koma in Notebooks</a></li><li><a class="tocitem" href="../../how-to/2-3-use-koma-scripts/">Use Koma in Julia Scripts</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-phantom/">Create Your Own Phantom</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-sequence/">Create Your Own Sequence</a></li><li><a class="tocitem" href="../../how-to/4-run-distributed-simulations/">Run Distributed Simulations</a></li><li><a class="tocitem" href="../../how-to/5-contribute-to-koma/">Contribute to Koma</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">🤔 Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../explanation/1-phantom/">Phantom</a></li><li><a class="tocitem" href="../../explanation/2-motion/">Motion</a></li><li><a class="tocitem" href="../../explanation/3-phantom-format/">Phantom File Format</a></li><li><a class="tocitem" href="../../explanation/4-sequence/">Sequence</a></li><li><a class="tocitem" href="../../explanation/5-seq-events/">Sequence Events</a></li><li><a class="tocitem" href="../../explanation/6-simulation/">Simulation</a></li><li><a class="tocitem" href="../../explanation/7-gpu-explanation/">GPU Parallelization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">👨‍💻 Reference Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/1-api/">API Overview</a></li><li><a class="tocitem" href="../../reference/2-koma-base/">KomaMRIBase</a></li><li><a class="tocitem" href="../../reference/3-koma-core/">KomaMRICore</a></li><li><a class="tocitem" href="../../reference/4-koma-files/">KomaMRIFiles</a></li><li><a class="tocitem" href="../../reference/5-koma-plots/">KomaMRIPlots</a></li><li><a class="tocitem" href="../../reference/6-koma-mri/">KomaMRI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">🏋️ Tutorials</a></li><li class="is-active"><a href>Arrhythmic Cardiac Cine MRI</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Arrhythmic Cardiac Cine MRI</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl/blob/master/docs/src/tutorial/lit-07-RRVariability.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Arrhythmic-Cardiac-Cine-MRI"><a class="docs-heading-anchor" href="#Arrhythmic-Cardiac-Cine-MRI">Arrhythmic Cardiac Cine MRI</a><a id="Arrhythmic-Cardiac-Cine-MRI-1"></a><a class="docs-heading-anchor-permalink" href="#Arrhythmic-Cardiac-Cine-MRI" title="Permalink"></a></h1><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Scanner
  B0: Float64 1.5
  B1: Float64 1.0e-5
  Gmax: Float64 0.06
  Smax: Int64 500
  ADC_Δt: Float64 2.0e-6
  seq_Δt: Float64 1.0e-5
  GR_Δt: Float64 1.0e-5
  RF_Δt: Float64 1.0e-6
  RF_ring_down_T: Float64 2.0e-5
  RF_dead_time_T: Float64 0.0001
  ADC_dead_time_T: Float64 1.0e-5
</code></pre><p><a href="../07-RRVariability.jl"><img src="https://img.shields.io/badge/julia-script-9558B2?logo=julia" alt/></a> <a href="../07-RRVariability.ipynb"><img src="https://img.shields.io/badge/jupyter-notebook-blue?logo=jupyter" alt/></a> <a href="https://mybinder.org/v2/gh/JuliaHealth/KomaMRI.jl/master?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FJuliaHealth%252FKomaMRI.jl%26urlpath%3Dlab%252Ftree%252FKomaMRI.jl%252Fdev%252Ftutorial%252F07-RRVariability.ipynb%26branch%3Dgh-pages"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><p>This tutorial shows how to simulate cardiac cine MRI using Koma. including cases with variable RR intervals (i.e., arrhythmias). You&#39;ll learn how to:</p><ol><li>Simulate a clean cine acquisition with constant RR intervals.</li><li>Introduce arrhythmias (variable RR) in the cardiac phantom.</li><li>Observe how this desynchronization degrades image quality.</li><li>Fix the acquisition by synchronizing the sequence with the phantom&#39;s RR variability (manual triggering).</li></ol><h3 id="1.-Constant-RR-for-Phantom-and-Sequence"><a class="docs-heading-anchor" href="#1.-Constant-RR-for-Phantom-and-Sequence">1. Constant RR for Phantom and Sequence</a><a id="1.-Constant-RR-for-Phantom-and-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#1.-Constant-RR-for-Phantom-and-Sequence" title="Permalink"></a></h3><p>We will begin by simulating a cardiac cine on a myocardial phantom with a constant RR interval. Let&#39;s call the <code>heart_phantom</code> function to create a ring-shaped phantom filled with blood, which resembles the left ventricle:</p><pre><code class="language-julia hljs">obj = heart_phantom()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phantom{Float64}
  name: String &quot;LeftVentricle&quot;
  x: Array{Float64}((12714,)) [-0.007573593128807149, -0.006866486347620604, -0.006159379566434059, -0.005452272785247507, -0.004745166004060962, -0.004038059222874417, -0.003330952441687865, -0.00262384566050132, -0.001916738879314775, -0.001209632098128223  …  -0.001916738879314775, -0.001209632098128223, -0.000502525316941678, 0.000204581464244874, 0.000911688245431419, 0.001618795026617964, 0.002325901807804516, 0.003033008588991061, 0.003740115370177606, 0.004447222151364158]
  y: Array{Float64}((12714,)) [-0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762, -0.04434314575050762  …  0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736, 0.04475230867899736]
  z: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  ρ: Array{Float64}((12714,)) [0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9  …  0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9, 0.9]
  T1: Array{Float64}((12714,)) [1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026  …  1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026, 1.026]
  T2: Array{Float64}((12714,)) [0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042  …  0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042, 0.042]
  T2s: Array{Float64}((12714,)) [1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6  …  1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6, 1.0e6]
  Δw: Array{Float64}((12714,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((12714,)) [2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9  …  2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9, 2.0e-9]
  Dλ2: Array{Float64}((12714,)) [1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10  …  1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10, 1.0e-10]
  Dθ: Array{Float64}((12714,)) [-0.16916284697591719, -0.1536287198547715, -0.1380195046747176, -0.12234231369025762, -0.10660445476529863, -0.090813412529144, -0.07497682827307205, -0.05910247871255467, -0.0431982537552276, -0.02727213342817287  …  -3.0987888698389616, -3.114569742820848, -3.130364088806849, 3.137021268443483, 3.121223600397341, 3.1054360932317397, 3.0896665955717584, 3.0739229023532744, 3.058212731905059, 3.0425437035966953]
  motion: MotionList{Float64}
</code></pre><p>By default, this phantom exhibits periodic contraction and rotation, with a period of 1 second:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/tut-6-phantom.html&quot;</code></pre><center><object type="text/html" data="../../assets/tut-6-phantom.html" style="width:90%; height:470px;"></object></center><p>Now, we will create a bSSFP cine sequence with the following parameters:</p><pre><code class="language-julia hljs">RRs          = [1.0]       # [s] constant RR interval
N_matrix     = 50          # image size = N x N
N_phases     = 40          # Number of cardiac phases
FOV          = 0.11        # [m]
TR           = 20e-3       # [s]
flip_angle   = 10          # [º]
adc_duration = 0.2e-3</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.0002</code></pre><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.0004097877 0.0004943697 … 0.00039761787 0.0004291129; 0.0006359431 0.000652328 … 0.00064038584 0.00063393125; … ; 0.0008648828 0.00085028296 … 0.0008954627 0.0008499241; 0.00058909704 0.0005692203 … 0.0006398941 0.0005800082]
 Float32[0.00081549573 0.00080457615 … 0.0008019951 0.0007963481; 0.00066525943 0.0007666247 … 0.000627322 0.0006752086; … ; 0.00067809265 0.00073108677 … 0.0007087002 0.00070097425; 0.0011060409 0.00097219914 … 0.0012408819 0.0010862662]
 Float32[0.0020175315 0.0020142482 … 0.0021348132 0.002040631; 0.0010743279 0.001121194 … 0.0010881881 0.0010929672; … ; 0.0004839282 0.0005497091 … 0.0005035455 0.0005248939; 0.0014152748 0.0013277817 … 0.0015708866 0.0014242751]
 Float32[0.0020283156 0.0020846655 … 0.0021304633 0.002094927; 0.0009612855 0.0009897583 … 0.0009981176 0.0009842203; … ; 0.00032393643 0.0003304619 … 0.0003055773 0.00031517466; 0.0011764542 0.00117756 … 0.0012832953 0.0012194966]
 Float32[0.0014369378 0.001389303 … 0.0014894544 0.0014170515; 0.00075103046 0.0007192002 … 0.0007719714 0.00073604775; … ; 0.00048629366 0.0004995836 … 0.00051013206 0.0005036124; 0.000894185 0.0009183516 … 0.0009419953 0.0009148824]
 Float32[0.00018404283 0.00026459523 … 0.00019424924 0.00022799594; 0.00061201164 0.00061782275 … 0.00061102596 0.0006061745; … ; 0.00069938676 0.0006982633 … 0.0007184423 0.0007088713; 0.0006538294 0.0006461538 … 0.00070483185 0.0006617475]
 Float32[0.0017287049 0.0017392983 … 0.0017715415 0.0017386246; 0.0010764758 0.001062955 … 0.0011043042 0.0010732748; … ; 0.0007169447 0.00066826417 … 0.00072048244 0.0006778803; 0.0008244289 0.00085035566 … 0.0008637664 0.00084559084]
 Float32[0.0019016246 0.0019149437 … 0.0019021564 0.0018849885; 0.0012330774 0.0011514432 … 0.0012276366 0.001166898; … ; 0.00066832424 0.000622572 … 0.000693484 0.0006529567; 0.00081358285 0.00082706055 … 0.0007472282 0.0007765804]
 Float32[0.00096873887 0.0008666467 … 0.0009460253 0.0008728022; 0.0007202433 0.0006573323 … 0.0007889818 0.0007156236; … ; 0.00059169135 0.00055191474 … 0.00064123154 0.00057221093; 0.00063524465 0.00067968795 … 0.0006051218 0.00061802106]
 Float32[0.0003268731 0.0003243761 … 0.00026464867 0.00026168296; 0.0005152027 0.0005282908 … 0.000527796 0.00050405425; … ; 0.0006473467 0.0006397858 … 0.00065875705 0.0006260146; 0.0006214464 0.00060063106 … 0.0006516413 0.00062853156]
 ⋮
 Float32[0.0015947283 0.0015466257 … 0.0016428982 0.0015763217; 0.0007935609 0.00077507505 … 0.00082777673 0.0007954759; … ; 0.00032139602 0.00029767337 … 0.00034125222 0.00031167915; 0.00079475687 0.0007902993 … 0.0008220842 0.0007952676]
 Float32[0.00083018484 0.0007702612 … 0.00083511503 0.000781303; 0.00034531782 0.00033456687 … 0.00032411827 0.00031708664; … ; 0.00016923308 0.00017478295 … 0.00017658422 0.00016459287; 0.00049403735 0.00043613213 … 0.0005190898 0.00046741604]
 Float32[0.00017746452 0.00026805513 … 0.00022455915 0.00026159856; 0.0002755538 0.00030076015 … 0.00030430898 0.00029487233; … ; 0.0002649909 0.00027194657 … 0.00027185093 0.0002691197; 0.00017403088 0.00018403755 … 0.00018959193 0.00018908562]
 Float32[0.0010787566 0.001116699 … 0.001161657 0.0011309043; 0.0006555344 0.0006806515 … 0.0007228599 0.0006990635; … ; 0.00035109415 0.00036345306 … 0.00038109513 0.00037324216; 0.0005418107 0.0005826218 … 0.0005851012 0.00058698247]
 Float32[0.0015618689 0.0016178571 … 0.0016628411 0.0016315818; 0.00080087245 0.00085165916 … 0.0008472261 0.00084528176; … ; 0.00032630315 0.00034257243 … 0.0003142489 0.0003221231; 0.0008484101 0.00085606496 … 0.0009359189 0.00089204]
 Float32[0.0014646989 0.0015021062 … 0.0015443942 0.0015129757; 0.000646069 0.0006866737 … 0.0006801852 0.00068239524; … ; 0.00019868149 0.00021665171 … 0.00018082531 0.000204464; 0.0008254423 0.0008230987 … 0.0008983882 0.000851104]
 Float32[0.00086944754 0.0009291486 … 0.00090309704 0.0009191181; 0.00029929023 0.0003590934 … 0.00030020584 0.0003308034; … ; 0.00015924098 0.0001680853 … 0.00017895528 0.00017263263; 0.0005174096 0.0005077923 … 0.0005708244 0.00054218835]
 Float32[7.23128f-5 6.1097126f-5 … 0.00011292067 8.152727f-5; 0.00026375247 0.0002433691 … 0.00029699624 0.0002660243; … ; 0.0002459052 0.00024887142 … 0.00029561095 0.00026842288; 0.00016755756 0.00016422957 … 0.00017650917 0.00015819973]
 Float32[0.00092703605 0.0009389044 … 0.0010276351 0.0009752308; 0.00058434164 0.0005617176 … 0.0006372726 0.0005871691; … ; 0.0002560915 0.00026696236 … 0.00030421783 0.00028682218; 0.0006695963 0.0006573945 … 0.00071000133 0.00066907966]</code></pre><p>The simulation and subsequent reconstruction produces the following cine frames, which look clean and temporally coherent:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames1.gif</code></pre><center><object data="../../assets/tut-7-frames1.gif" style="width:40%"></object></center><h3 id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence"><a class="docs-heading-anchor" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence">2. Arrhythmic Phantom: Variable RR, Constant Sequence</a><a id="2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence-1"></a><a class="docs-heading-anchor-permalink" href="#2.-Arrhythmic-Phantom:-Variable-RR,-Constant-Sequence" title="Permalink"></a></h3><p>Now, we will introduce arrhythmias in the phantom by modifying its RR intervals. However, we will keep the sequence with a constant RR interval of 1 second:</p><pre><code class="language-julia hljs">RRs = [900, 1100, 1000, 1000, 1000, 800] .* 1e-3</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.9
 1.1
 1.0
 1.0
 1.0
 0.8</code></pre><div class="admonition is-info" id="Note-ddbe442881ba9190"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-ddbe442881ba9190" title="Permalink"></a></header><div class="admonition-body"><p>The <code>RRs</code> array contains <strong>scaling factors</strong> relative to the original duration of the phantom’s motion cycle.</p><p>In this example, the base duration of the cardiac motion is 1 second, which is defined within the <code>t</code> field of its <a href="../../explanation/3-phantom-format/#TimeCurve"><code>TimeCurve</code></a> structure. Consequently, the elements in <code>RRs</code> directly represent the actual RR intervals in seconds (e.g., 0.9 s, 1.1 s, etc.).</p></div></div><pre><code class="language-julia hljs"># Apply the new RRs to the phantom (both contraction and rotation):
obj.motion.motions[1].time.periods = RRs
obj.motion.motions[2].time.periods = RRs</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Float64}:
 0.9
 1.1
 1.0
 1.0
 1.0
 0.8</code></pre><p>Since the sequence still assumes a constant RR, it becomes unsynchronized with the phantom. This produces artifacts and temporal inconsistencies in the cine.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.010534127 0.010252588 … 0.0079754 0.010537243; 0.010812697 0.011185724 … 0.006740383 0.010815793; … ; 0.0065860515 0.00708105 … 0.0068822843 0.0065843314; 0.011729317 0.0119052 … 0.0059719244 0.011742971]
 Float32[0.008779768 0.006221733 … 0.0053817555 0.008756635; 0.0031664046 0.007788788 … 0.0023886624 0.003168103; … ; 0.009574039 0.007896332 … 0.0063829655 0.009568557; 0.008772146 0.0031396975 … 0.009306103 0.008761402]
 Float32[0.0043928307 0.005453033 … 0.009630146 0.004362987; 0.0031888033 0.010503694 … 0.012515954 0.0031901875; … ; 0.009248886 0.008836452 … 0.004723678 0.009265673; 0.009846493 0.0048022917 … 0.014022416 0.009837453]
 Float32[0.010192602 0.010764301 … 0.0053342055 0.010207272; 0.012710707 0.014039455 … 0.011826812 0.012715442; … ; 0.005156949 0.0066412776 … 0.0048251213 0.005168652; 0.01295551 0.012758879 … 0.010178374 0.012960012]
 Float32[0.0062740133 0.007660763 … 0.003531353 0.0062661557; 0.011808255 0.013634607 … 0.009273863 0.011806682; … ; 0.0017392578 0.0046358868 … 0.0019939889 0.0017566392; 0.014201784 0.011430734 … 0.006780857 0.01420551]
 Float32[0.0033872407 0.0051259 … 0.010322909 0.0033709216; 0.011237524 0.011764081 … 0.0072695455 0.011227376; … ; 0.0032634612 0.0028444184 … 0.0014338717 0.0032678347; 0.012374401 0.013119718 … 0.011473842 0.012373484]
 Float32[0.0049060155 0.0069775786 … 0.0049203094 0.0049187364; 0.0086800195 0.013105795 … 0.0060859467 0.008676045; … ; 0.0045394828 0.006511882 … 0.013230401 0.0045465454; 0.013749948 0.008974965 … 0.008271377 0.01377165]
 Float32[0.0058274516 0.012789841 … 0.014057503 0.0058160666; 0.008938067 0.011994836 … 0.0075004776 0.008964147; … ; 0.007951464 0.011177594 … 0.0053792614 0.007958863; 0.011034189 0.008960435 … 0.010073663 0.011012102]
 Float32[0.012980404 0.013704345 … 0.0028601119 0.012949867; 0.0017153283 0.0027166246 … 0.008060242 0.0016720382; … ; 0.006955192 0.004520642 … 0.007256697 0.0069713355; 0.0033021737 0.003706198 … 0.0035162885 0.0032904816]
 Float32[0.006946145 0.007869229 … 0.01053937 0.006974682; 0.0067645516 0.004016541 … 0.005330816 0.0067366147; … ; 0.004367086 0.0065071285 … 0.0019680697 0.004378171; 0.0060867495 0.0076571926 … 0.0056314883 0.006091366]
 ⋮
 Float32[0.0034148495 0.005113493 … 0.008475382 0.0034286552; 0.0076467665 0.0006797428 … 0.008796372 0.007657754; … ; 0.0057126596 0.004000858 … 0.002201947 0.0056974306; 0.003949479 0.010551007 … 0.006650651 0.0039473926]
 Float32[0.0067862915 0.0067994385 … 0.005894384 0.006790902; 0.007970391 0.00090050115 … 0.00661853 0.007962079; … ; 0.007960988 0.002194405 … 0.0077668135 0.00796813; 0.0030821443 0.007569386 … 0.0039872974 0.0030672543]
 Float32[0.0066828025 0.0062180846 … 0.0001358578 0.006692537; 0.0064680497 0.0021027403 … 0.0033572258 0.006476782; … ; 0.004483903 0.0016198878 … 0.0060630064 0.0044679567; 0.0024816405 0.006265773 … 0.0045059994 0.0024973494]
 Float32[0.0046868464 0.006065942 … 0.0017155004 0.0047310223; 0.0048193773 0.004340002 … 0.0028379306 0.004829842; … ; 0.0008436795 0.0031140784 … 0.00072993693 0.00084456796; 0.0042688 0.0048533943 … 0.0049680714 0.004297392]
 Float32[0.0075527537 0.0091837095 … 0.003174405 0.0076045687; 0.009312765 0.0056399675 … 0.0036341012 0.009350911; … ; 0.0034763124 0.0043632556 … 0.0041113812 0.0034753017; 0.0072085466 0.010077368 … 0.0007855162 0.007249138]
 Float32[0.013963807 0.012565241 … 0.015930155 0.013987689; 0.011886887 0.009582443 … 0.011912844 0.011918232; … ; 0.002365144 0.0054784254 … 0.005068971 0.0023479005; 0.011861668 0.011606995 … 0.008961228 0.0118766455]
 Float32[0.013682625 0.012650361 … 0.01581212 0.013676576; 0.013118427 0.008949465 … 0.012279133 0.01314169; … ; 0.0067347833 0.0024020781 … 0.0042389045 0.006725206; 0.009297111 0.012943659 … 0.011201898 0.009307802]
 Float32[0.005218843 0.007044995 … 0.016060444 0.0051973416; 0.0058017764 0.008160322 … 0.01035897 0.005790272; … ; 0.0045365035 0.0019829536 … 0.0039640814 0.004552097; 0.009045387 0.0064198957 … 0.012156882 0.009046983]
 Float32[0.0029629502 0.0038558228 … 0.019372882 0.0029427116; 0.008371815 0.0032436736 … 0.014197672 0.008356287; … ; 0.0015045395 0.0059584156 … 0.0013863785 0.0015313235; 0.0053192843 0.010337202 … 0.012072827 0.005309887]</code></pre><h3 id="3.-Prospective-Triggering:-Resynchronized-Acquisition"><a class="docs-heading-anchor" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition">3. Prospective Triggering: Resynchronized Acquisition</a><a id="3.-Prospective-Triggering:-Resynchronized-Acquisition-1"></a><a class="docs-heading-anchor-permalink" href="#3.-Prospective-Triggering:-Resynchronized-Acquisition" title="Permalink"></a></h3><p>To correct this, we synchronize the sequence by providing it the same RR variability as the phantom:</p><pre><code class="language-julia hljs">seq = bSSFP_cine(
    FOV, N_matrix, TR, flip_angle, RRs, N_phases, sys;
    N_dummy_cycles = 40, adc_duration = adc_duration,
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Sequence[ τ = 97000.0 ms | blocks: 24051 | ADC: 2000 | GR: 16000 | RF: 4000 | DEF: 5 ]</code></pre><p>This manually mimics cardiac triggering. The resulting cine is once again correctly aligned, despite the underlying arrhythmia.</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">40-element Vector{Any}:
 Float32[0.0012602641 0.000108634216 … 0.0016337817 0.0012762774; 0.0015652847 0.00011881626 … 0.0015549314 0.0015594726; … ; 0.00031254534 0.0016101011 … 0.0024633629 0.00032522678; 0.00012852752 0.0013117563 … 0.0014822176 0.00013630775]
 Float32[0.0035266336 0.0026170323 … 0.009371552 0.0035565863; 0.004641326 0.0043028654 … 0.008825266 0.0046640174; … ; 0.00432408 0.003679729 … 0.00575217 0.0043477663; 0.0040548136 0.003718821 … 0.009682121 0.0040927655]
 Float32[0.00238348 0.0014738775 … 0.0018391617 0.002404707; 0.0033227038 0.0042440086 … 0.006256526 0.003334186; … ; 0.0062730517 0.008057698 … 0.013051394 0.0063068396; 0.004437267 0.0034488023 … 0.007183911 0.0044795945]
 Float32[0.013485125 0.012913531 … 0.019012919 0.013538655; 0.008867417 0.011455597 … 0.016372668 0.00887959; … ; 0.0047286353 0.0050402246 … 0.0055671376 0.004731903; 0.011888025 0.008502169 … 0.0136753265 0.011906455]
 Float32[0.0064510815 0.0063994923 … 0.00046282363 0.0064432817; 0.009127492 0.011845944 … 0.014864703 0.009139307; … ; 0.012592731 0.014578136 … 0.022335326 0.01261373; 0.011693964 0.009472998 … 0.015589283 0.011716172]
 Float32[0.01605197 0.015868705 … 0.02467572 0.016063908; 0.009357853 0.014668028 … 0.019648565 0.009362738; … ; 0.002632059 0.005076339 … 0.009161539 0.0026485587; 0.014130309 0.0096947625 … 0.01343226 0.0141284065]
 Float32[0.009113633 0.009031576 … 0.012354913 0.009091852; 0.013899134 0.018766172 … 0.018253475 0.013889308; … ; 0.018122362 0.020157665 … 0.015583525 0.018133523; 0.018154114 0.013774849 … 0.0154288905 0.018154243]
 Float32[0.020271055 0.02264707 … 0.01572657 0.02027581; 0.0073873196 0.021210728 … 0.0135240555 0.0074249967; … ; 0.014026208 0.015084983 … 0.016555661 0.0140203005; 0.020741886 0.007718134 … 0.004612252 0.020792695]
 Float32[0.010945633 0.012443512 … 0.009467535 0.0110046975; 0.00569645 0.019746736 … 0.022787854 0.0057276995; … ; 0.014446893 0.015777145 … 0.012890535 0.014454609; 0.020156892 0.006085122 … 0.012680544 0.020145573]
 Float32[0.017218504 0.014976845 … 0.01797621 0.017184595; 0.006935329 0.010068625 … 0.013206726 0.0069356775; … ; 0.008278382 0.008479512 … 0.01456434 0.008285296; 0.011081265 0.006344675 … 0.019085415 0.011071424]
 ⋮
 Float32[0.021929627 0.021821214 … 0.027690668 0.021972677; 0.01694863 0.016154464 … 0.0229648 0.01695994; … ; 0.0033821533 0.0021996722 … 0.00088233966 0.0033737142; 0.016422087 0.016737068 … 0.019439915 0.016449424]
 Float32[0.018187283 0.01819228 … 0.020926356 0.018211791; 0.015073029 0.014704512 … 0.019068632 0.015088583; … ; 0.0046006623 0.0034675668 … 0.0063293516 0.0045983084; 0.014923976 0.014659697 … 0.018454846 0.014943398]
 Float32[0.013205959 0.0136826 … 0.011404201 0.013224894; 0.01236008 0.011654929 … 0.01312971 0.012351301; … ; 0.0070549594 0.006336654 … 0.008320129 0.0070646545; 0.012022433 0.012382591 … 0.01191936 0.012022603]
 Float32[0.004764643 0.0053581735 … 0.004076798 0.0047716317; 0.0067216693 0.005902014 … 0.0046376325 0.0067275334; … ; 0.0072768307 0.00629165 … 0.011454516 0.007288646; 0.0061666933 0.006628025 … 0.0082185 0.0061626746]
 Float32[0.0025420683 0.001774259 … 0.011530866 0.0025566223; 0.0049378052 0.0008265687 … 0.0043076137 0.004942234; … ; 0.0070712017 0.0068154414 … 0.009396607 0.0070841876; 0.0014712635 0.0042413957 … 0.007994858 0.001489854]
 Float32[0.009846605 0.009139972 … 0.018415079 0.009869999; 0.0076433206 0.0054288707 … 0.012441424 0.007663181; … ; 0.0054561715 0.005017152 … 0.007911871 0.005467836; 0.004997024 0.0064850706 … 0.012941846 0.005014825]
 Float32[0.013630024 0.012753014 … 0.023302052 0.013679372; 0.010883617 0.0092124855 … 0.0177969 0.010894718; … ; 0.0032804909 0.0039041832 … 0.0030326273 0.0032909196; 0.0087719355 0.009408797 … 0.018305328 0.0087829465]
 Float32[0.016108336 0.015677582 … 0.02338127 0.016132506; 0.0131451 0.011945538 … 0.020473469 0.013144258; … ; 0.0028826892 0.0020749422 … 0.0024618343 0.0028771649; 0.011372783 0.012136346 … 0.019468242 0.011376779]
 Float32[0.0159279 0.015422658 … 0.02063487 0.015932903; 0.013371385 0.012354469 … 0.019329986 0.013399432; … ; 0.004229625 0.0028876318 … 0.00593398 0.004238535; 0.011983014 0.012709737 … 0.018997798 0.011972104]</code></pre><p>Below we compare the results from the desynchronized 👎 and resynchronized 🕐 acquisitions:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Saved animation to /home/runner/work/KomaMRI.jl/KomaMRI.jl/docs/build/assets/tut-7-frames_comparison.gif</code></pre><center><object data="../../assets/tut-7-frames_comparison.gif" style="width:80%"></object></center><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../06-DiffusionMotion/">« Diffusion-induced Signal Attenuation</a><a class="docs-footer-nextpage" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.12.0 on <span class="colophon-date" title="Thursday 12 June 2025 14:18">Thursday 12 June 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
