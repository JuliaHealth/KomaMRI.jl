<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Motion · KomaMRI.jl</title><meta name="title" content="Motion · KomaMRI.jl"/><meta property="og:title" content="Motion · KomaMRI.jl"/><meta property="twitter:title" content="Motion · KomaMRI.jl"/><meta name="description" content="Documentation for KomaMRI.jl."/><meta property="og:description" content="Documentation for KomaMRI.jl."/><meta property="twitter:description" content="Documentation for KomaMRI.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/hide-documenter-example-output.css" rel="stylesheet" type="text/css"/><link href="../../assets/center-images.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img class="docs-light-only" src="../../assets/logo.svg" alt="KomaMRI.jl logo"/><img class="docs-dark-only" src="../../assets/logo-dark.svg" alt="KomaMRI.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">🏠 Home</a></li><li><a class="tocitem" href="../../how-to/1-getting-started/">🏃 Getting Started</a></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">🏋️ Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial/01-FID/">Free Induction Decay</a></li><li><a class="tocitem" href="../../tutorial/02-SmallTipApproximation/">Small Tip Angle Approximation</a></li><li><a class="tocitem" href="../../tutorial/03-ChemicalShiftEPI/">Chemical Shift in an EPI sequence</a></li><li><a class="tocitem" href="../../tutorial/04-3DSliceSelective/">Slice-Selective Acquisition of 3D Phantom</a></li><li><a class="tocitem" href="../../tutorial/05-SimpleMotion/">Patient&#39;s Motion During Acquisition</a></li><li><a class="tocitem" href="../../tutorial/06-DiffusionMotion/">Diffusion-induced Signal Attenuation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">🧑‍🔬 Reproducible Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorial-pluto/01-gradient-echo-spin-echo/">Understanding basic MRI sequences</a></li><li><a class="tocitem" href="../../tutorial-pluto/02-low-field-cmra-optimization/">Low-Field CMRA Optimization</a></li><li><a class="tocitem" href="../../tutorial-pluto/03-low-field-boost-optimization/">Low-Field BOOST Optimization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">👨‍🍳 How to</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../how-to/2-1-use-koma-ui/">Use Koma&#39;s User Interface</a></li><li><a class="tocitem" href="../../how-to/2-2-use-koma-notebooks/">Use Koma in Notebooks</a></li><li><a class="tocitem" href="../../how-to/2-3-use-koma-scripts/">Use Koma in Julia Scripts</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-phantom/">Create Your Own Phantom</a></li><li><a class="tocitem" href="../../how-to/3-create-your-own-sequence/">Create Your Own Sequence</a></li><li><a class="tocitem" href="../../how-to/4-run-distributed-simulations/">Run Distributed Simulations</a></li><li><a class="tocitem" href="../../how-to/5-contribute-to-koma/">Contribute to Koma</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox" checked/><label class="tocitem" for="menuitem-6"><span class="docs-label">🤔 Explanations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../1-phantom/">Phantom</a></li><li class="is-active"><a class="tocitem" href>Motion</a><ul class="internal"><li><a class="tocitem" href="#Understanding-the-motion-field-and-its-possible-values"><span>Understanding the <code>motion</code> field and its possible values</span></a></li><li><a class="tocitem" href="#The-Motion-structure-and-its-fields"><span>The <code>Motion</code> structure and its fields</span></a></li><li><a class="tocitem" href="#See-it-in-action"><span>See it in action</span></a></li></ul></li><li><a class="tocitem" href="../3-phantom-format/">Phantom File Format</a></li><li><a class="tocitem" href="../4-sequence/">Sequence</a></li><li><a class="tocitem" href="../5-seq-events/">Sequence Events</a></li><li><a class="tocitem" href="../6-simulation/">Simulation</a></li><li><a class="tocitem" href="../7-gpu-explanation/">GPU Parallelization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">👨‍💻 Reference Guides</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../reference/1-api/">API Overview</a></li><li><a class="tocitem" href="../../reference/2-koma-base/">KomaMRIBase</a></li><li><a class="tocitem" href="../../reference/3-koma-core/">KomaMRICore</a></li><li><a class="tocitem" href="../../reference/4-koma-files/">KomaMRIFiles</a></li><li><a class="tocitem" href="../../reference/5-koma-plots/">KomaMRIPlots</a></li><li><a class="tocitem" href="../../reference/6-koma-mri/">KomaMRI</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">🤔 Explanations</a></li><li class="is-active"><a href>Motion</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Motion</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaHealth/KomaMRI.jl/blob/master/docs/src/explanation/lit-2-motion.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Motion"><a class="docs-heading-anchor" href="#Motion">Motion</a><a id="Motion-1"></a><a class="docs-heading-anchor-permalink" href="#Motion" title="Permalink"></a></h1><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Phantom{Float64}
  name: String &quot;brain2D_axial&quot;
  x: Array{Float64}((6506,)) [-0.084, -0.084, -0.084, -0.084, -0.084, -0.084, -0.084, -0.084, -0.084, -0.084  …  0.084, 0.084, 0.084, 0.084, 0.086, 0.086, 0.086, 0.086, 0.086, 0.086]
  y: Array{Float64}((6506,)) [-0.03, -0.028, -0.026, -0.024, -0.022, -0.02, -0.018, -0.016, -0.014, -0.012  …  0.006, 0.008, 0.01, 0.012, -0.008, -0.006, -0.004, -0.002, 0.0, 0.002]
  z: Array{Float64}((6506,)) [-0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0, -0.0  …  0.0, 0.0, 0.0, 0.0, -0.0, -0.0, -0.0, -0.0, 0.0, 0.0]
  ρ: Array{Float64}((6506,)) [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
  T1: Array{Float64}((6506,)) [0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569  …  0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569, 0.569]
  T2: Array{Float64}((6506,)) [0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329  …  0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329, 0.329]
  T2s: Array{Float64}((6506,)) [0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058  …  0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058, 0.058]
  Δw: Array{Float64}((6506,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ1: Array{Float64}((6506,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dλ2: Array{Float64}((6506,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  Dθ: Array{Float64}((6506,)) [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
  motion: NoMotion NoMotion()
</code></pre><p><a href="../2-motion.jl"><img src="https://img.shields.io/badge/julia-script-9558B2?logo=julia" alt/></a> <a href="../2-motion.ipynb"><img src="https://img.shields.io/badge/jupyter-notebook-blue?logo=jupyter" alt/></a> <a href="https://mybinder.org/v2/gh/JuliaHealth/KomaMRI.jl/master?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FJuliaHealth%252FKomaMRI.jl%26urlpath%3Dlab%252Ftree%252FKomaMRI.jl%252Fdev%252Ftutorial%252F2-motion.ipynb%26branch%3Dgh-pages"><img src="https://mybinder.org/badge_logo.svg" alt/></a></p><p>Koma can easily simulate the effects of motion during acquisitions. As introduced in the <a href="../1-phantom/">previous section</a>, the motion-related information of the phantom is stored in the <code>motion</code> field of its structure.</p><p>Koma&#39;s motion model has been designed to accomodate a variety of real-world scenarios, including:</p><ul><li><a href="../../tutorial/05-SimpleMotion/">Patient motion inside a scanner</a>, which may involve simultaneous or sequential translations and rotations of body parts during the acquisition.</li><li>Myocardial motion, including simulataneous contraction, rotation, torsion, and translation motion within the cardiac cycle.</li><li>Pseudo-periodic heart patterns, caused by variations in heart rate or arrhythmias that prevent the heart&#39;s motion from being perfectly periodic.</li><li>Flow through blood vessels, where the spin trajectories or fluid fields may have been obtained from Computational Fluid Dynamics (CFD) simulations.</li><li><a href="../../tutorial/06-DiffusionMotion/">Diffusion</a>, which can be modeled, among many other ways, as microscopic Brownian spin trajectories.</li></ul><p>... And, ultimately, any type of motion you can think of, no matter how complex!</p><p>To handle these scenarios, Koma represents motion as a collection of elementary movements that can be independently configured and combined. This approach allows for the definition of any complex motion pattern, with the ability to specify overlapping time intervals and even model bidirectional motions along predefined trajectories.</p><h2 id="Understanding-the-motion-field-and-its-possible-values"><a class="docs-heading-anchor" href="#Understanding-the-motion-field-and-its-possible-values">Understanding the <code>motion</code> field and its possible values</a><a id="Understanding-the-motion-field-and-its-possible-values-1"></a><a class="docs-heading-anchor-permalink" href="#Understanding-the-motion-field-and-its-possible-values" title="Permalink"></a></h2><p>The <code>motion</code> field within the <code>Phantom</code> struct can take different values depending on whether the phantom is static or dynamic. For static phantoms, the field is set to <code>NoMotion</code>. For dynamic phantoms, the field can be either a <code>Motion</code> or a <code>MotionList</code> struct. A <code>Motion</code> represents a single movement, characterized by an <code>action</code>, a <code>time</code> curve, and a range of affected <code>spins</code>. Regarding the <code>MotionList</code> struct, it is simply a collection of <code>Motion</code> instances, which is useful for defining motion compositions.</p><pre><code class="language-julia hljs">struct Phantom{T&lt;:Real}
    (...)
    #Motion
    motion::Union{NoMotion, Motion{T}, MotionList{T}} = NoMotion()
end</code></pre><h3 id="NoMotion-struct"><a class="docs-heading-anchor" href="#NoMotion-struct"><code>NoMotion</code> struct</a><a id="NoMotion-struct-1"></a><a class="docs-heading-anchor-permalink" href="#NoMotion-struct" title="Permalink"></a></h3><p><code>NoMotion</code> is the default type for static phantoms. Since its structure has no fields, making a phantom static is as simple as:</p><pre><code class="language-julia hljs">obj.motion = NoMotion()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">NoMotion()</code></pre><h3 id="Motion-struct"><a class="docs-heading-anchor" href="#Motion-struct"><code>Motion</code> struct</a><a id="Motion-struct-1"></a><a class="docs-heading-anchor-permalink" href="#Motion-struct" title="Permalink"></a></h3><p>The <code>Motion</code> struct contains information about a basic motion, understood as the combination of an <code>action</code>, a <code>time</code> curve and a <code>spins</code> span. This three fields will be described in detail later. Here is an example of how to assign a motion to a phantom in this case:</p><pre><code class="language-julia hljs">obj.motion = Motion(Translate(0.0, 0.1, 0.2), TimeRange(0.0, 1.0), AllSpins())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Motion{Float64}
  action: Translate{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>There are <code>Motion</code> constructors that simplify its definition:</p><pre><code class="language-julia hljs">obj.motion = Translate(0.0, 0.1, 0.2, TimeRange(0.0, 1.0), AllSpins())</code></pre></div></div><h3 id="MotionList-struct"><a class="docs-heading-anchor" href="#MotionList-struct"><code>MotionList</code> struct</a><a id="MotionList-struct-1"></a><a class="docs-heading-anchor-permalink" href="#MotionList-struct" title="Permalink"></a></h3><p>The <code>MotionList</code> struct contains a single field called <code>motions</code>, which is a vector of <code>Motion</code> instances. This design makes it possible to define both sequential and simultaneous concatenations of motions over time. An example of how this would be used is:</p><pre><code class="language-julia hljs">obj.motion = MotionList(
    Motion(Translate(0.0, 0.1, 0.2), TimeRange(0.0, 1.0), AllSpins()),
    Motion(Rotate(0.0, 0.0, 45.0), Periodic(1.0, 0.5), SpinRange(1:1000))
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MotionList{Float64}(Motion{Float64}[Motion{Float64}
  action: Translate{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
, Motion{Float64}
  action: Rotate{Float64}
  time: TimeCurve{Float64}
  spins: SpinRange
])</code></pre><h2 id="The-Motion-structure-and-its-fields"><a class="docs-heading-anchor" href="#The-Motion-structure-and-its-fields">The <code>Motion</code> structure and its fields</a><a id="The-Motion-structure-and-its-fields-1"></a><a class="docs-heading-anchor-permalink" href="#The-Motion-structure-and-its-fields" title="Permalink"></a></h2><p>The <code>Motion</code> struct is the basic building block for defining motion in Koma. As we mentioned earlier, it has three main fields: <code>action</code>, <code>time</code>, and <code>spins</code>. Together, these fields define what the motion is, when it happens, and which spins are involved:</p><pre><code class="language-julia hljs">struct Motion{T&lt;:Real}
    action::AbstractAction{T}
    time  ::TimeCurve{T}
    spins ::AbstractSpinSpan
end</code></pre><h3 id="The-action-field"><a class="docs-heading-anchor" href="#The-action-field">The <code>action</code> field</a><a id="The-action-field-1"></a><a class="docs-heading-anchor-permalink" href="#The-action-field" title="Permalink"></a></h3><p>Let&#39;s start with the <code>action</code> field, which defines the type and magnitude (i.e., the final state) of the motion. Currently, Koma supports five actions: <a href="../../reference/2-koma-base/#KomaMRIBase.Translate"><code>Translate</code></a>, <a href="../../reference/2-koma-base/#KomaMRIBase.Rotate"><code>Rotate</code></a>, <a href="../../reference/2-koma-base/#KomaMRIBase.HeartBeat"><code>HeartBeat</code></a>, <a href="../../reference/2-koma-base/#KomaMRIBase.Path"><code>Path</code></a>, and <a href="../../reference/2-koma-base/#KomaMRIBase.FlowPath"><code>FlowPath</code></a>. The first three fall under the category of <em>SimpleActions</em>, while the last two belong to the <em>ArbitraryActions</em>. <em>SimpleActions</em> are defined by parameters that are easy to understand and use, such as translation distance, rotation angles, or contraction rates. <em>ArbitraryActions</em>, on the other hand, are more complex and can be defined by a set of spin trajectories.</p><h3 id="The-time-field"><a class="docs-heading-anchor" href="#The-time-field">The <code>time</code> field</a><a id="The-time-field-1"></a><a class="docs-heading-anchor-permalink" href="#The-time-field" title="Permalink"></a></h3><p>The <code>time</code> field defines how the motion behaves over time and must be an instance of the <code>TimeCurve</code> struct, which works similarly to animation curves in video editing, 3D design, or video games. Essentially, it allows you to adjust the &quot;timing&quot; of the motion without affecting its magnitude or other characteristics.</p><p>Given an initial and final state (see the <code>action</code> field), time curves allow you to define how the transition between those states should occur. The <code>TimeCurve</code> structure lets you define an animation curve by specifying the coordinates of its points, along with two additional parameters that control its periodicity and pseudo-periodicity:</p><pre><code class="language-julia hljs">struct TimeCurve{T&lt;:Real}
    t::AbstractVector{T}
    t_unit::AbstractVector{T}
    periodic::Bool
    periods::Union{T,AbstractVector{T}}
end</code></pre><p>This enables you to create any type of curve, and thus, any kind of motion pattern over time.</p><p>A full description of this structure, including examples and constructors, can be found in the <a href="../../reference/2-koma-base/#KomaMRIBase.TimeCurve"><code>TimeCurve</code> API reference</a>.</p><h3 id="The-spins-field"><a class="docs-heading-anchor" href="#The-spins-field">The <code>spins</code> field</a><a id="The-spins-field-1"></a><a class="docs-heading-anchor-permalink" href="#The-spins-field" title="Permalink"></a></h3><p>Finally, the <code>spins</code> field must be an instance of the <a href="../../reference/2-koma-base/#AbstractSpinSpan-types"><code>AbstractSpinSpan</code></a> type. It defines which spins in the phantom are affected by the motion, and which of them remain static. This allows you to define motions that only affect a subset of spins, while keeping others unaffected.</p><h2 id="See-it-in-action"><a class="docs-heading-anchor" href="#See-it-in-action">See it in action</a><a id="See-it-in-action-1"></a><a class="docs-heading-anchor-permalink" href="#See-it-in-action" title="Permalink"></a></h2><p>Now that we have a basic understanding of the <code>motion</code> field and its components, let&#39;s see some usage examples. In all cases, we start with the same phantom: a hollow cube with 1 mm side length and 20 µm spin spacing, centered at the origin and aligned with the coordinate axes. To make the motion easier to visualize, each face of the cube is given a different T1 value:</p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/doc-2-phantom.html&quot;</code></pre><center><object type="text/html" data="../../assets/doc-2-phantom.html" style="width:85%; height:470px;"></object></center><h3 id="Translation-motion"><a class="docs-heading-anchor" href="#Translation-motion">Translation motion</a><a id="Translation-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Translation-motion" title="Permalink"></a></h3><p>In this first example, we&#39;ve added a translational motion of -0.5, 0.6, and 0.7 mm along the three spatial directions. The motion lasts for 1 second and affects the entire phantom:</p><pre><code class="language-julia hljs">obj.motion = Translate(-5e-4, 6e-4, 7e-4, TimeRange(0.0, 1.0), AllSpins())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Motion{Float64}
  action: Translate{Float64}
  time: TimeCurve{Float64}
  spins: AllSpins AllSpins()
</code></pre><p>Let’s plot this phantom and see how it moves. The <code>time_samples</code> argument specifies the number of time samples to be plotted. You can use the bottom slider to scroll through time and check its exact position at each moment:</p><pre><code class="language-julia hljs">p1 = plot_phantom_map(obj, :T1; time_samples=11, height=440)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/doc-2-translate.html&quot;</code></pre><center><object type="text/html" data="../../assets/doc-2-translate.html" style="width:85%; height:470px;"></object></center><h3 id="Rotation-motion"><a class="docs-heading-anchor" href="#Rotation-motion">Rotation motion</a><a id="Rotation-motion-1"></a><a class="docs-heading-anchor-permalink" href="#Rotation-motion" title="Permalink"></a></h3><p>In this case, we add a rotational motion to the phantom: 90º around the y-axis and 75º around the z-axis. Like before, the motion lasts for 1 second and affects all spins in the phantom:</p><pre><code class="language-julia hljs">obj.motion = Rotate(0.0, 90.0, 75.0, TimeRange(0.0, 1.0), AllSpins())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/doc-2-rotate.html&quot;</code></pre><center><object type="text/html" data="../../assets/doc-2-rotate.html" style="width:85%; height:470px;"></object></center><h3 id="Adding-motion-to-a-phantom-subset"><a class="docs-heading-anchor" href="#Adding-motion-to-a-phantom-subset">Adding motion to a phantom subset</a><a id="Adding-motion-to-a-phantom-subset-1"></a><a class="docs-heading-anchor-permalink" href="#Adding-motion-to-a-phantom-subset" title="Permalink"></a></h3><p>Sometimes, you may want to assign motion to just a part of the phantom instead of the whole thing. This can be done using the <a href="../../reference/2-koma-base/#KomaMRIBase.SpinRange"><code>SpinRange</code></a> structure, where you specify the indices of the spins that should be affected. In this example, we apply a translational motion to the upper half of the phantom:</p><pre><code class="language-julia hljs">obj.motion = Translate(-5e-4, 6e-4, 7e-4, TimeRange(0.0, 1.0), SpinRange(7500:15002))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/doc-2-subset.html&quot;</code></pre><center><object type="text/html" data="../../assets/doc-2-subset.html" style="width:85%; height:470px;"></object></center><h3 id="Motion-combination"><a class="docs-heading-anchor" href="#Motion-combination">Motion combination</a><a id="Motion-combination-1"></a><a class="docs-heading-anchor-permalink" href="#Motion-combination" title="Permalink"></a></h3><p>You can freely add multiple motions to a phantom, each with its own type, time span, and affected spin range. These motions can overlap in time (affecting the phantom simultaneously) or happen one after another. Both cases are fully supported, so you&#39;re free to combine different effects across various parts of the phantom and time intervals, creating as complex a motion pattern as you need.</p><p>This final example shows two brain phantoms undergoing the same translational and rotational motions, but with different time spans. In the top phantom, the translation takes place from 0 to 0.5 seconds, followed by the rotation from 0.5 to 1 second. In the bottom phantom, both motions happen over the same time span, from 0 to 1 second:</p><pre><code class="language-julia hljs">obj1.motion = MotionList(
    Translate(40e-2, 0.0, 0.0, TimeRange(0.0, 0.5),AllSpins()),
    Rotate(0.0, 0.0, 90.0, TimeRange(0.5, 1.0),AllSpins()),
)

obj2.motion = MotionList(
    Translate(40e-2, 0.0, 0.0, TimeRange(0.0, 1.0),AllSpins()),
    Rotate(0.0, 0.0, 90.0, TimeRange(0.0, 1.0),AllSpins()),
)

obj = obj1 + obj2</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;../assets/doc-2-combination.html&quot;</code></pre><center><object type="text/html" data="../../assets/doc-2-combination.html" style="width:85%; height:470px;"></object></center><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1-phantom/">« Phantom</a><a class="docs-footer-nextpage" href="../3-phantom-format/">Phantom File Format »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.10.1 on <span class="colophon-date" title="Thursday 10 April 2025 11:38">Thursday 10 April 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
