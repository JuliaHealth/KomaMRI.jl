import{_ as n,C as r,o as s,c as l,aA as C,E as d,w as o,j as t,a as e}from"./chunks/framework.DSs4OLzh.js";const V=JSON.parse('{"title":"Patient&#39;s Motion During Acquisition","description":"","frontmatter":{},"headers":[],"relativePath":"tutorial/05-SimpleMotion.md","filePath":"tutorial/05-SimpleMotion.md","lastUpdated":null}'),m={name:"tutorial/05-SimpleMotion.md"},h={class:"MathJax",jax:"SVG",overflow:"linebreak"},p={style:{"vertical-align":"-0.025ex"},xmlns:"http://www.w3.org/2000/svg",width:"1.179ex",height:"1.595ex",role:"img",focusable:"false",viewBox:"0 -694 521 705"},g={class:"MathJax",jax:"SVG",overflow:"linebreak"},L={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.036ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 1784 996"},k={class:"MathJax",jax:"SVG",overflow:"linebreak"},c={style:{"vertical-align":"-0.464ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.185ex",height:"2.084ex",role:"img",focusable:"false",viewBox:"0 -716 2733.9 921"},x={class:"MathJax",jax:"SVG",overflow:"linebreak"},f={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"4.118ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 1820 996"},u={class:"mjx-scroll-wrapper"},b={class:"MathJax",jax:"SVG",overflow:"linebreak",display:"true"},_={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"40.785ex",height:"2.692ex",role:"img",focusable:"false",viewBox:"0 -941.9 18026.8 1189.9"},y={class:"MathJax",jax:"SVG",overflow:"linebreak"},E={style:{"vertical-align":"-0.561ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.615ex",height:"2.253ex",role:"img",focusable:"false",viewBox:"0 -748 2923.7 996"},M={class:"MathJax",jax:"SVG",overflow:"linebreak"},w={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.615ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2923.7 1000"},T={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.506ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2875.8 1000"},D={class:"MathJax",jax:"SVG",overflow:"linebreak"},v={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"3.912ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 1729 1000"},Z={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.263ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2768.4 1000"},A={style:{"vertical-align":"-0.566ex"},xmlns:"http://www.w3.org/2000/svg",width:"6.673ex",height:"2.262ex",role:"img",focusable:"false",viewBox:"0 -750 2949.4 1000"};function F(j,a,S,R,P,I){const i=r("center");return s(),l("div",null,[a[31]||(a[31]=C('<h1 id="Patient&#39;s-Motion-During-Acquisition" tabindex="-1">Patient&#39;s Motion During Acquisition <a class="header-anchor" href="#Patient&#39;s-Motion-During-Acquisition" aria-label="Permalink to &quot;Patient&amp;#39;s Motion During Acquisition {#Patient&#39;s-Motion-During-Acquisition}&quot;">​</a></h1><p><a href="./tutorial/05-SimpleMotion.jl"><img src="https://img.shields.io/badge/julia-script-9558B2?logo=julia" alt=""></a> <a href="./tutorial/05-SimpleMotion.ipynb"><img src="https://img.shields.io/badge/jupyter-notebook-blue?logo=jupyter" alt=""></a> <a href="https://mybinder.org/v2/gh/JuliaHealth/KomaMRI.jl/master?urlpath=git-pull%3Frepo%3Dhttps%253A%252F%252Fgithub.com%252FJuliaHealth%252FKomaMRI.jl%26urlpath%3Dlab%252Ftree%252FKomaMRI.jl%252Fdev%252Ftutorial%252F05-SimpleMotion.ipynb%26branch%3Dgh-pages" target="_blank" rel="noreferrer"><img src="https://mybinder.org/badge_logo.svg" alt=""></a></p><p>It can also be interesting to see the effect of the patient&#39;s motion during an MRI scan. For this, Koma provides the ability to add <code>motion</code> to the phantom. In this tutorial, we will show how to add a <a href="/KomaMRI.jl/previews/PR725/reference/2-koma-base#KomaMRIBase.translate"><code>translate</code></a> motion to a 2D brain phantom.</p><p>First, let&#39;s load the 2D brain phantom used in the previous tutorials:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> brain_phantom2D</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h3 id="Head-Translation" tabindex="-1">Head Translation <a class="header-anchor" href="#Head-Translation" aria-label="Permalink to &quot;Head Translation {#Head-Translation}&quot;">​</a></h3><p>In this example, we will add a <a href="/KomaMRI.jl/previews/PR725/reference/2-koma-base#KomaMRIBase.translate"><code>translate</code></a> of 2 cm in x, with duration of 200 ms (v = 0.1 m/s):</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">motion </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> translate</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2e-2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">TimeRange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(t_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, t_end</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">200e-3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span></code></pre></div>',8)),d(i,null,{default:o(()=>[...a[0]||(a[0]=[t("object",{type:"text/html",data:"../../assets/tut-5-phantom.html",style:{width:"85%",height:"470px"}},null,-1)])]),_:1}),a[32]||(a[32]=t("p",null,"If we simulate an EPI sequence with acquisition duration (183.989 ms) comparable with the motion's duration (200 ms), we will observe motion-induced artifacts in the reconstructed image.",-1)),d(i,null,{default:o(()=>[...a[1]||(a[1]=[t("object",{type:"text/html",data:"../../assets/tut-5-recon1.html",style:{width:"65%",height:"420px"}},null,-1)])]),_:1}),t("p",null,[a[3]||(a[3]=e("The severity of the artifacts can vary depending on the acquisition duration and ",-1)),t("mjx-container",h,[(s(),l("svg",p,[...a[2]||(a[2]=[t("g",{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"},[t("g",{"data-mml-node":"math","data-latex":"k"},[t("g",{"data-mml-node":"mi","data-latex":"k"},[t("path",{"data-c":"1D458",d:"M409 353C409 327 423 314 450 314C485 314 508 345 508 379C508 418 476 445 437 445C392 445 344 415 291 356C250 311 217 282 190 269L291 679C289 688 287 694 274 694C242 694 166 685 154 684C139 682 132 675 132 660C132 650 141 645 159 645C178 645 204 646 204 632L59 43C56 32 55 25 55 21C55 0 66-11 87-11C104-11 117-3 124 12C129 21 147 92 179 226C231 221 286 196 286 146C286 131 279 101 279 91C279 34 316-11 373-11C431-11 470 41 490 145C490 154 485 159 475 159C466 159 460 152 457 138C435 59 408 19 375 19C357 19 348 33 348 61C348 77 360 131 360 147C360 204 314 239 221 253C244 269 270 292 298 322C326 352 346 371 359 382C386 404 412 415 435 415C445 415 453 413 459 409C432 404 409 379 409 353Z"})])])],-1)])]))]),a[4]||(a[4]=e("-space trajectory.",-1))]),a[33]||(a[33]=t("h3",{id:"Motion-Corrected-Reconstruction",tabindex:"-1"},[e("Motion-Corrected Reconstruction "),t("a",{class:"header-anchor",href:"#Motion-Corrected-Reconstruction","aria-label":'Permalink to "Motion-Corrected Reconstruction {#Motion-Corrected-Reconstruction}"'},"​")],-1)),t("p",null,[a[8]||(a[8]=e("To correct for the motion-induced artifacts we can perform a motion-corrected reconstruction. This can be achieved by multiplying each sample of the acquired signal ",-1)),t("mjx-container",g,[(s(),l("svg",L,[...a[5]||(a[5]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="S(t)"><g data-mml-node="mi" data-latex="S"><path data-c="1D446" d="M133 157C133 181 136 201 141 217C141 227 136 232 125 232C120 232 116 230 114 228C109 223 52 8 52-8C52-17 57-22 67-22C72-22 79-17 88-6L133 47C168 1 224-22 300-22C366-22 424 5 476 58C528 111 554 170 554 236C554 283 538 323 505 355C490 368 470 379 445 388C422 393 400 399 378 405L312 423C279 432 254 469 254 509C254 552 271 589 306 621C341 653 380 669 423 669C515 669 561 619 561 520C561 502 557 482 557 465L557 462C560 455 565 451 573 451C582 451 588 459 592 474L645 691C645 700 640 705 630 705C625 705 618 700 609 689L566 637C538 682 491 705 424 705C361 705 304 681 254 634C202 586 176 531 176 468C176 396 223 339 282 323L387 296C441 281 475 262 475 195C475 149 457 108 422 72C387 36 347 17 302 17C204 17 133 60 133 157Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(645,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(1034,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1395,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),a[9]||(a[9]=e(" by a phase shift ",-1)),t("mjx-container",k,[(s(),l("svg",c,[...a[6]||(a[6]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\Delta\\phi_{\\mathrm{corr}}"><g data-mml-node="mi" data-latex="\\Delta"><path data-c="394" d="M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"></path></g><g data-mml-node="msub" data-latex="\\phi_{\\mathrm{corr}}" transform="translate(833,0)"><g data-mml-node="mi" data-latex="\\phi"><path data-c="1D719" d="M385 445C404 524 424 601 442 680L442 683C439 690 434 694 426 694C417 694 411 686 408 671L351 445C276 442 208 414 147 362C82 307 49 243 49 170C49 62 132-7 237-13C218-92 204-149 195-183C194-186 194-189 194-190C194-200 199-205 210-205C221-205 224-199 227-187L271-14C346-11 414 17 475 69C540 125 573 189 573 262C573 369 488 436 385 445M377 415C453 410 501 363 501 283C501 243 492 203 474 164C442 92 369 26 278 17M121 149C121 189 130 229 148 268C180 340 253 405 343 415L244 16C169 22 121 69 121 149Z"></path></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-latex="{\\mathrm{corr}}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{corr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="corr"><path data-c="63" d="M251 416C293 416 325 406 347 386C323 383 306 361 306 338C306 305 322 289 355 289C388 289 404 306 404 339C404 410 327 448 250 448C188 448 137 426 96 380C55 334 34 279 34 216C34 155 55 101 96 56C137 11 187-11 248-11C298-11 337 3 365 32C388 55 403 78 411 102C414 111 415 117 415 121C415 130 409 134 398 134C390 134 385 130 382 122C361 55 320 21 257 21C228 21 200 34 172 61C139 92 123 144 123 218C123 318 161 416 251 416Z"></path><path data-c="6F" d="M249-11C311-11 363 11 406 55C449 99 471 152 471 214C471 277 450 332 408 378C366 424 313 448 250 448C187 448 135 424 92 378C49 332 28 277 28 214C28 152 49 99 92 55C135 11 188-11 249-11M250 21C202 21 166 42 141 85C125 113 117 159 117 222C117 283 125 327 140 355C164 398 200 419 249 419C296 419 332 398 357 357C374 329 382 284 382 222C382 106 348 21 250 21Z" transform="translate(444,0)"></path><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z" transform="translate(944,0)"></path><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z" transform="translate(1336,0)"></path></g></g></g></g></g></g>',1)])]))]),a[10]||(a[10]=e(" proportional to the displacement ",-1)),t("mjx-container",x,[(s(),l("svg",f,[...a[7]||(a[7]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(t)"><g data-mml-node="mi" data-latex="\\boldsymbol{u}"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(681,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(1070,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(1431,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),a[11]||(a[11]=e()),a[12]||(a[12]=t("a",{href:"https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4930872/",target:"_blank",rel:"noreferrer"},"[Godenschweger, 2016]",-1)),a[13]||(a[13]=e(":",-1))]),t("div",u,[t("mjx-container",b,[(s(),l("svg",_,[...a[14]||(a[14]=[C(`<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="S_{\\mathrm{MC}}\\left(t\\right)=S\\left(t\\right)\\cdot\\mathrm{e}^{\\mathrm{i}\\Delta\\phi_{\\mathrm{corr}}}=S\\left(t\\right)\\cdot\\mathrm{e}^{\\mathrm{i}2\\pi\\boldsymbol{k}\\left(t\\right)\\cdot\\boldsymbol{u}\\left(t\\right)}
"><g data-mml-node="msub" data-latex="S_{\\mathrm{MC}}"><g data-mml-node="mi" data-latex="S"><path data-c="1D446" d="M133 157C133 181 136 201 141 217C141 227 136 232 125 232C120 232 116 230 114 228C109 223 52 8 52-8C52-17 57-22 67-22C72-22 79-17 88-6L133 47C168 1 224-22 300-22C366-22 424 5 476 58C528 111 554 170 554 236C554 283 538 323 505 355C490 368 470 379 445 388C422 393 400 399 378 405L312 423C279 432 254 469 254 509C254 552 271 589 306 621C341 653 380 669 423 669C515 669 561 619 561 520C561 502 557 482 557 465L557 462C560 455 565 451 573 451C582 451 588 459 592 474L645 691C645 700 640 705 630 705C625 705 618 700 609 689L566 637C538 682 491 705 424 705C361 705 304 681 254 634C202 586 176 531 176 468C176 396 223 339 282 323L387 296C441 281 475 262 475 195C475 149 457 108 422 72C387 36 347 17 302 17C204 17 133 60 133 157Z"></path></g><g data-mml-node="TeXAtom" transform="translate(646,-150) scale(0.707)" data-latex="{\\mathrm{MC}}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{MC}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="MC"><path data-c="4D" d="M175 108L175 622L407 24C413 8 421 0 430 0C439 0 446 7 452 21L689 630L689 81C689 63 685 51 678 46C671 41 650 39 615 39L587 39L587 0C614 2 663 3 733 3C803 3 852 2 879 0L879 39L851 39C816 39 795 41 788 46C781 51 777 63 777 81L777 602C777 620 781 631 788 636C795 641 816 644 851 644L879 644L879 683L708 683C681 683 679 682 671 662L458 115L247 659C238 679 235 683 208 683L37 683L37 644L65 644C100 644 121 641 128 636C135 631 139 620 139 602L139 108C139 91 135 77 127 64C116 47 86 39 37 39L37 0L157 3L277 0L277 39C204 39 175 51 175 108Z"></path><path data-c="43" d="M665 443L665 677C665 696 660 705 650 705C643 705 637 700 631 691L584 622C554 653 522 675 487 689C461 700 433 705 403 705C306 705 223 670 156 598C89 526 56 441 56 342C56 243 89 158 155 87C222 14 305-22 403-22C474-22 536 3 588 53C640 103 665 163 665 234C665 248 659 255 648 255C638 255 633 251 633 242C633 241 633 239 632 236C626 116 540 17 415 17C378 17 341 27 302 47C210 97 166 193 166 341C166 481 215 589 302 636C341 656 378 666 414 666C538 666 609 553 626 435C627 422 634 415 645 415C665 415 665 423 665 443Z" transform="translate(917,0)"></path></g></g></g></g><g data-mml-node="mrow" data-latex="\\left(t\\right)" transform="translate(2021.6,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(389,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(750,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g><g data-mml-node="mo" data-latex="=" transform="translate(3438.4,0)"><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="S" transform="translate(4494.2,0)"><path data-c="1D446" d="M133 157C133 181 136 201 141 217C141 227 136 232 125 232C120 232 116 230 114 228C109 223 52 8 52-8C52-17 57-22 67-22C72-22 79-17 88-6L133 47C168 1 224-22 300-22C366-22 424 5 476 58C528 111 554 170 554 236C554 283 538 323 505 355C490 368 470 379 445 388C422 393 400 399 378 405L312 423C279 432 254 469 254 509C254 552 271 589 306 621C341 653 380 669 423 669C515 669 561 619 561 520C561 502 557 482 557 465L557 462C560 455 565 451 573 451C582 451 588 459 592 474L645 691C645 700 640 705 630 705C625 705 618 700 609 689L566 637C538 682 491 705 424 705C361 705 304 681 254 634C202 586 176 531 176 468C176 396 223 339 282 323L387 296C441 281 475 262 475 195C475 149 457 108 422 72C387 36 347 17 302 17C204 17 133 60 133 157Z"></path></g><g data-mml-node="mrow" data-latex="\\left(t\\right)" transform="translate(5305.8,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(389,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(750,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g><g data-mml-node="mo" data-latex="\\cdot" transform="translate(6667.1,0)"><path data-c="22C5" d="M192 250C192 279 168 303 139 303C110 303 86 279 86 250C86 221 110 197 139 197C168 197 192 221 192 250Z"></path></g><g data-mml-node="msup" data-latex="\\mathrm{e}^{\\mathrm{i}\\Delta\\phi_{\\mathrm{corr}}}" transform="translate(7167.3,0)"><g data-mml-node="TeXAtom" data-latex="\\mathrm{e}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="e"><path data-c="65" d="M415 251C415 366 348 448 236 448C176 448 126 425 85 378C47 334 28 281 28 220C28 157 49 104 91 58C133 12 185-11 247-11C304-11 348 9 378 48C403 81 415 105 415 121C415 131 409 136 398 136C390 136 385 131 382 120C360 54 317 21 253 21C208 21 173 42 146 85C127 116 118 163 117 227L387 227C409 227 415 229 415 251M326 349C337 316 342 284 342 255L118 255C121 321 138 366 168 389C193 409 215 419 236 419C281 419 311 396 326 349Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(477,413) scale(0.707)" data-latex="{\\mathrm{i}\\Delta\\phi_{\\mathrm{corr}}}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{i}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="i"><path data-c="69" d="M194 601C194 631 169 657 139 657C109 657 83 631 83 601C83 571 108 544 138 544C169 544 194 570 194 601M143 3L247 0L247 39C214 39 194 41 188 45C182 49 180 60 180 78L180 445L37 433L37 395C70 395 91 392 98 387C105 382 108 368 108 345L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z"></path></g></g><g data-mml-node="mi" data-latex="\\Delta" transform="translate(278,0)"><path data-c="394" d="M759 0C776 0 785 4 785 13L445 696C438 709 429 716 416 716C403 716 394 709 387 696L52 25C49 18 47 14 47 12C47 4 56 0 73 0M384 604L644 83L124 83Z"></path></g><g data-mml-node="msub" data-latex="\\phi_{\\mathrm{corr}}" transform="translate(1111,0)"><g data-mml-node="mi" data-latex="\\phi"><path data-c="1D719" d="M385 445C404 524 424 601 442 680L442 683C439 690 434 694 426 694C417 694 411 686 408 671L351 445C276 442 208 414 147 362C82 307 49 243 49 170C49 62 132-7 237-13C218-92 204-149 195-183C194-186 194-189 194-190C194-200 199-205 210-205C221-205 224-199 227-187L271-14C346-11 414 17 475 69C540 125 573 189 573 262C573 369 488 436 385 445M377 415C453 410 501 363 501 283C501 243 492 203 474 164C442 92 369 26 278 17M121 149C121 189 130 229 148 268C180 340 253 405 343 415L244 16C169 22 121 69 121 149Z"></path></g><g data-mml-node="TeXAtom" transform="translate(629,-150) scale(0.707)" data-latex="{\\mathrm{corr}}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{corr}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="corr"><path data-c="63" d="M251 416C293 416 325 406 347 386C323 383 306 361 306 338C306 305 322 289 355 289C388 289 404 306 404 339C404 410 327 448 250 448C188 448 137 426 96 380C55 334 34 279 34 216C34 155 55 101 96 56C137 11 187-11 248-11C298-11 337 3 365 32C388 55 403 78 411 102C414 111 415 117 415 121C415 130 409 134 398 134C390 134 385 130 382 122C361 55 320 21 257 21C228 21 200 34 172 61C139 92 123 144 123 218C123 318 161 416 251 416Z"></path><path data-c="6F" d="M249-11C311-11 363 11 406 55C449 99 471 152 471 214C471 277 450 332 408 378C366 424 313 448 250 448C187 448 135 424 92 378C49 332 28 277 28 214C28 152 49 99 92 55C135 11 188-11 249-11M250 21C202 21 166 42 141 85C125 113 117 159 117 222C117 283 125 327 140 355C164 398 200 419 249 419C296 419 332 398 357 357C374 329 382 284 382 222C382 106 348 21 250 21Z" transform="translate(444,0)"></path><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z" transform="translate(944,0)"></path><path data-c="72" d="M364 378C364 417 327 442 288 442C237 442 198 412 172 351L172 442L28 431L28 393C63 393 84 390 92 384C100 378 104 365 104 342L104 79C104 60 101 48 94 44C87 40 65 38 28 38L28 0L143 3C185 4 228 3 271 0L271 38L247 38C214 38 193 41 186 46C179 51 176 63 176 81L176 232C176 275 184 314 199 347C219 390 248 412 287 413C277 403 272 391 272 377C272 346 287 331 318 331C345 331 364 352 364 378Z" transform="translate(1336,0)"></path></g></g></g></g></g></g><g data-mml-node="mo" data-latex="=" transform="translate(10101.8,0)"><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="S" transform="translate(11157.6,0)"><path data-c="1D446" d="M133 157C133 181 136 201 141 217C141 227 136 232 125 232C120 232 116 230 114 228C109 223 52 8 52-8C52-17 57-22 67-22C72-22 79-17 88-6L133 47C168 1 224-22 300-22C366-22 424 5 476 58C528 111 554 170 554 236C554 283 538 323 505 355C490 368 470 379 445 388C422 393 400 399 378 405L312 423C279 432 254 469 254 509C254 552 271 589 306 621C341 653 380 669 423 669C515 669 561 619 561 520C561 502 557 482 557 465L557 462C560 455 565 451 573 451C582 451 588 459 592 474L645 691C645 700 640 705 630 705C625 705 618 700 609 689L566 637C538 682 491 705 424 705C361 705 304 681 254 634C202 586 176 531 176 468C176 396 223 339 282 323L387 296C441 281 475 262 475 195C475 149 457 108 422 72C387 36 347 17 302 17C204 17 133 60 133 157Z"></path></g><g data-mml-node="mrow" data-latex="\\left(t\\right)" transform="translate(11969.2,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(389,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(750,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g><g data-mml-node="mo" data-latex="\\cdot" transform="translate(13330.4,0)"><path data-c="22C5" d="M192 250C192 279 168 303 139 303C110 303 86 279 86 250C86 221 110 197 139 197C168 197 192 221 192 250Z"></path></g><g data-mml-node="msup" data-latex="\\mathrm{e}^{\\mathrm{i}2\\pi\\boldsymbol{k}\\left(t\\right)\\cdot\\boldsymbol{u}\\left(t\\right)}" transform="translate(13830.7,0)"><g data-mml-node="TeXAtom" data-latex="\\mathrm{e}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="e"><path data-c="65" d="M415 251C415 366 348 448 236 448C176 448 126 425 85 378C47 334 28 281 28 220C28 157 49 104 91 58C133 12 185-11 247-11C304-11 348 9 378 48C403 81 415 105 415 121C415 131 409 136 398 136C390 136 385 131 382 120C360 54 317 21 253 21C208 21 173 42 146 85C127 116 118 163 117 227L387 227C409 227 415 229 415 251M326 349C337 316 342 284 342 255L118 255C121 321 138 366 168 389C193 409 215 419 236 419C281 419 311 396 326 349Z"></path></g></g><g data-mml-node="TeXAtom" transform="translate(477,413) scale(0.707)" data-latex="{\\mathrm{i}2\\pi\\boldsymbol{k}\\left(t\\right)\\cdot\\boldsymbol{u}\\left(t\\right)}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{i}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="i"><path data-c="69" d="M194 601C194 631 169 657 139 657C109 657 83 631 83 601C83 571 108 544 138 544C169 544 194 570 194 601M143 3L247 0L247 39C214 39 194 41 188 45C182 49 180 60 180 78L180 445L37 433L37 395C70 395 91 392 98 387C105 382 108 368 108 345L108 79C108 60 105 48 98 44C91 40 69 39 33 39L33 0Z"></path></g></g><g data-mml-node="mn" data-latex="2" transform="translate(278,0)"><path data-c="32" d="M237 666C186 666 143 648 106 612C69 576 50 534 50 483C50 449 75 424 106 424C136 424 161 450 161 480C161 513 137 536 105 536C102 536 100 536 98 535C117 584 161 627 224 627C306 627 352 556 352 470C352 403 318 331 250 255L62 43C49 28 50 29 50 0L421 0L450 180L417 180C409 129 402 100 396 91C391 86 361 84 306 84L139 84L236 179C304 243 390 312 419 365C439 400 449 435 449 470C449 588 357 666 237 666Z"></path></g><g data-mml-node="mi" data-latex="\\pi" transform="translate(778,0)"><path data-c="1D70B" d="M524 431L194 431C153 431 117 415 88 384C74 369 27 305 27 292C31 285 31 279 43 279C50 279 56 283 62 292C94 341 135 366 184 366L235 366C212 279 170 172 110 45C105 33 102 24 102 19C102-1 113-11 134-11C153-11 167 0 176 21C194 78 207 122 214 152L269 366L372 366C345 247 331 164 331 117C331 68 342-11 379-11C400-11 423 9 423 30C423 35 421 43 417 53C398 100 389 153 389 214C389 261 395 312 406 366L515 366C550 366 567 378 567 403C567 426 549 431 524 431Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{k}" transform="translate(1348,0)"><path data-c="1D48C" d="M305 95C305 30 367-8 433-8C533-8 570 140 570 148C570 162 555 162 546 162C528 162 526 160 521 142C513 113 489 28 438 28C422 28 412 37 412 67C412 77 414 96 420 119C423 130 423 137 423 144C423 229 322 245 250 252C260 259 284 275 339 328C416 404 458 416 488 416C507 416 514 404 514 404C464 397 445 357 445 332C445 310 462 286 495 286C514 286 567 299 567 370C567 422 534 452 491 452C430 452 375 408 316 351C306 340 258 294 220 273L316 659C320 673 320 676 320 676C320 689 309 694 298 694C294 694 293 694 291 693L162 687C148 686 130 685 130 657C130 639 149 639 156 639C167 639 185 639 198 637L54 60C53 56 50 41 50 37C50 13 69-8 98-8C116-8 145 1 159 32L205 215C224 213 311 201 311 140C311 129 305 106 305 95Z"></path></g><g data-mml-node="mrow" data-latex="\\left(t\\right)" transform="translate(1952,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(389,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(750,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g><g data-mml-node="mo" data-latex="\\cdot" transform="translate(3091,0)"><path data-c="22C5" d="M192 250C192 279 168 303 139 303C110 303 86 279 86 250C86 221 110 197 139 197C168 197 192 221 192 250Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{u}" transform="translate(3369,0)"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mrow" data-latex="\\left(t\\right)" transform="translate(4050,0)"><g data-mml-node="mo" data-latex="\\left("><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(389,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex="\\right)" transform="translate(750,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g></g></g></g>`,1)])]))])]),t("p",null,[a[24]||(a[24]=e("In practice, we would need to estimate or measure the motion before performing a motion-corrected reconstruction, but for this example, we will directly use the displacement functions ",-1)),t("mjx-container",y,[(s(),l("svg",E,[...a[15]||(a[15]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}, t)"><g data-mml-node="mi" data-latex="\\boldsymbol{u}"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(681,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{x}" transform="translate(1070,0)"><path data-c="1D499" d="M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(1729,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(2173.7,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(2534.7,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),a[25]||(a[25]=e(" defined by ",-1)),a[26]||(a[26]=t("code",null,"obj.motion::MotionList",-1)),a[27]||(a[27]=e(". Since translations are rigid motions (",-1)),t("mjx-container",M,[(s(),l("svg",w,[...a[16]||(a[16]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}, t)=\\boldsymbol{u}(t)"><g data-mml-node="mi" data-latex="\\boldsymbol{u}"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(681,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{x}" transform="translate(1070,0)"><path data-c="1D499" d="M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(1729,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(2173.7,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(2534.7,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])])),a[18]||(a[18]=t("mjx-break",{size:"4"}," ",-1)),(s(),l("svg",T,[...a[17]||(a[17]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}, t)=\\boldsymbol{u}(t)"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{u}" transform="translate(1055.8,0)"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(1736.8,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="t" transform="translate(2125.8,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="mo" data-latex=")" transform="translate(2486.8,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),a[28]||(a[28]=e(" no position dependence), we can obtain the required displacements by calculating ",-1)),t("mjx-container",D,[(s(),l("svg",v,[...a[19]||(a[19]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}=\\boldsymbol{0},\\ t=t_{\\mathrm{adc}})"><g data-mml-node="mi" data-latex="\\boldsymbol{u}"><path data-c="1D496" d="M647 148C647 162 632 162 623 162C612 162 608 162 603 157C601 155 601 153 595 128C575 50 553 28 527 28C512 28 504 38 504 65C504 82 508 98 518 138C532 198 547 258 563 317C570 345 582 393 582 400C582 421 566 444 535 444C519 444 482 435 469 391L412 163C406 140 399 111 397 93C379 69 340 28 289 28C230 28 229 78 229 101C229 162 260 240 288 312C298 338 301 345 301 362C301 420 243 452 188 452C82 452 32 316 32 296C32 282 47 282 56 282C68 282 75 282 79 295C112 406 166 416 182 416C189 416 199 416 199 395C199 372 187 344 183 332C141 227 122 171 122 122C122 8 222-8 281-8C310-8 354-4 408 47C440-2 498-8 522-8C559-8 588 13 609 49C634 89 647 143 647 148Z"></path></g><g data-mml-node="mo" data-latex="(" transform="translate(681,0)"><path data-c="28" d="M318-248C327-248 332-243 332-234C332-231 330-227 327-223C275-183 233-117 202-26C175 53 161 131 161 208L161 292C161 369 175 447 202 526C233 617 275 683 327 723C330 726 332 730 332 734C332 743 327 748 318 748C317 748 314 747 311 745C251 699 201 631 160 540C121 453 101 371 101 292L101 208C101 129 121 47 160-40C201-131 251-199 311-245C314-247 317-248 318-248Z"></path></g><g data-mml-node="mi" data-latex="\\boldsymbol{x}" transform="translate(1070,0)"><path data-c="1D499" d="M604 364C604 417 551 452 490 452C433 452 396 409 383 391C358 433 302 452 245 452C119 452 51 329 51 296C51 282 66 282 75 282C87 282 94 282 98 295C127 386 199 416 240 416C278 416 296 398 296 366C296 347 282 292 273 256L239 119C224 58 188 28 154 28C149 28 126 28 106 43C142 53 160 87 160 112C160 134 143 158 110 158C75 158 38 129 38 80C38 27 91-8 152-8C209-8 246 35 259 53C284 11 340-8 397-8C523-8 591 115 591 148C591 162 576 162 567 162C555 162 548 162 544 149C515 58 443 28 402 28C364 28 346 46 346 78C346 99 359 152 368 189L403 325C418 385 453 416 488 416C493 416 516 416 536 401C500 391 482 357 482 332C482 310 499 286 532 286C567 286 604 315 604 364Z"></path></g></g></g>',1)])])),a[22]||(a[22]=t("mjx-break",{size:"4"}," ",-1)),(s(),l("svg",Z,[...a[20]||(a[20]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}=\\boldsymbol{0},\\ t=t_{\\mathrm{adc}})"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="mn" data-latex="\\boldsymbol{0}" transform="translate(1055.8,0)"><path data-c="1D7CE" d="M529 319C529 416 528 655 287 655C46 655 45 417 45 319C45 220 46-11 287-11C527-11 529 219 529 319M401 331C401 275 401 184 394 132C380 39 317 25 287 25C251 25 195 47 182 120C173 172 173 276 173 331C173 403 173 468 181 520C193 609 263 619 287 619C324 619 365 600 384 556C401 519 401 413 401 331Z"></path></g><g data-mml-node="mo" data-latex="," transform="translate(1630.8,0)"><path data-c="2C" d="M139 106C107 106 86 82 86 50C86 20 109-5 139-5C153-5 165-1 174 8L175 0C175-63 154-117 112-160C105-168 101-174 101-178C101-188 105-193 114-193C123-193 135-181 152-158C186-110 203-57 203 0C203 53 185 106 139 106Z"></path></g><g data-mml-node="mtext" data-latex="\\ " transform="translate(2075.4,0)"><path data-c="A0" d=""></path></g><g data-mml-node="mi" data-latex="t" transform="translate(2407.4,0)"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g></g></g>',1)])])),a[23]||(a[23]=t("mjx-break",{size:"4"}," ",-1)),(s(),l("svg",A,[...a[21]||(a[21]=[C('<g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math" data-latex="\\boldsymbol{u}(\\boldsymbol{x}=\\boldsymbol{0},\\ t=t_{\\mathrm{adc}})"><g data-mml-node="mo" data-latex="="><path data-c="3D" d="M698 367L80 367C64 367 56 359 56 344C56 329 64 321 80 321L698 321C714 321 722 329 722 344C722 356 711 367 698 367M698 179L80 179C64 179 56 171 56 156C56 141 64 133 80 133L698 133C714 133 722 141 722 156C722 169 711 179 698 179Z"></path></g><g data-mml-node="msub" data-latex="t_{\\mathrm{adc}}" transform="translate(1055.8,0)"><g data-mml-node="mi" data-latex="t"><path data-c="1D461" d="M330 419C330 428 320 433 299 433L218 433C244 537 257 591 257 595C257 616 246 626 225 626C202 626 188 613 182 587L145 433L56 433C34 433 23 432 23 411C23 400 33 395 54 395L135 395C86 200 62 97 62 84C62 28 100-11 156-11C194-11 227 6 256 41C280 70 297 98 308 125C312 136 314 142 314 145C314 154 309 159 299 159C291 159 285 154 281 143C247 60 206 19 157 19C140 19 131 33 131 60C131 75 133 91 137 107L208 395L297 395C323 395 330 397 330 419Z"></path></g><g data-mml-node="TeXAtom" transform="translate(394,-150) scale(0.707)" data-latex="{\\mathrm{adc}}" data-mjx-texclass="ORD"><g data-mml-node="TeXAtom" data-latex="\\mathrm{adc}" data-mjx-texclass="ORD"><g data-mml-node="mi" data-latex="adc"><path data-c="61" d="M483 91L483 150L451 150L451 91C451 52 440 32 419 32C399 32 387 57 387 77L387 274C387 309 383 335 376 353C352 412 283 448 213 448C136 448 60 405 60 333C60 300 77 283 110 283C143 283 159 299 159 332C159 361 144 378 113 381C135 406 168 419 211 419C273 419 311 362 311 297L311 264C233 259 174 247 133 228C66 197 32 154 32 97C32 71 42 49 61 32C93 3 137-11 193-11C252-11 294 14 320 65C327 27 355-6 398-6C451-6 483 36 483 91M200 18C154 18 116 52 116 98C116 191 213 231 311 236L311 141C311 74 267 18 200 18Z"></path><path data-c="64" d="M374-11L527 0L527 38C491 38 470 40 462 46C454 52 450 67 450 90L450 694L301 683L301 645C336 645 358 642 366 636C374 630 377 616 377 593L377 390C345 427 305 445 257 445C195 445 142 423 99 378C56 333 34 279 34 216C34 155 54 102 95 57C136 12 186-11 247-11C298-11 341 8 374 47M261 415C304 415 339 396 364 358C371 347 374 336 374 323L374 121C374 108 371 97 364 86C336 41 298 19 251 19C210 19 177 39 151 80C133 110 124 155 124 215C124 324 161 415 261 415Z" transform="translate(500,0)"></path><path data-c="63" d="M251 416C293 416 325 406 347 386C323 383 306 361 306 338C306 305 322 289 355 289C388 289 404 306 404 339C404 410 327 448 250 448C188 448 137 426 96 380C55 334 34 279 34 216C34 155 55 101 96 56C137 11 187-11 248-11C298-11 337 3 365 32C388 55 403 78 411 102C414 111 415 117 415 121C415 130 409 134 398 134C390 134 385 130 382 122C361 55 320 21 257 21C228 21 200 34 172 61C139 92 123 144 123 218C123 318 161 416 251 416Z" transform="translate(1056,0)"></path></g></g></g></g><g data-mml-node="mo" data-latex=")" transform="translate(2560.4,0)"><path data-c="29" d="M78-245C138-199 188-131 229-40C268 47 288 129 288 208L288 292C288 371 268 453 229 540C188 631 138 699 78 745C75 747 72 748 71 748C62 748 57 743 57 734C57 730 59 726 62 723C114 683 156 617 187 526C214 447 228 369 228 292L228 208C228 131 214 53 187-26C156-117 114-183 62-223C59-227 57-231 57-234C57-243 62-248 71-248C72-248 75-247 78-245Z"></path></g></g></g>',1)])]))]),a[29]||(a[29]=e(".",-1))]),a[34]||(a[34]=C(`<div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sample_times </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_adc_sampling_times</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(seq1)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">displacements </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> hcat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">get_spin_coords</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(obj</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">motion, [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], sample_times)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div>`,1)),d(i,null,{default:o(()=>[...a[30]||(a[30]=[t("object",{type:"text/html",data:"../../assets/tut-5-displacements.html",style:{width:"80%",height:"300px"}},null,-1)])]),_:1}),a[35]||(a[35]=C(`<p>We can now get the necessary phase shift for each sample:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_, kspace </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> get_kspace</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(seq1)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ΔΦ </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2π</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(kspace </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> displacements, dims</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><p>And apply it to the acquired signal to correct its phase:</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">acq1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">kdata[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.*=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> exp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.(im</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ΔΦ)</span></span></code></pre></div><p>Finally, we compare the original image ▶️ and the motion-corrected reconstruction ⏸️: <object type="text/html" data="../../assets/tut-5-recon1.html" style="width:50%;height:420px;"></object><object type="text/html" data="../../assets/tut-5-recon2.html" style="width:50%;height:420px;"></object></p><hr><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl" target="_blank" rel="noreferrer">Literate.jl</a>.</em></p>`,7))])}const q=n(m,[["render",F]]);export{V as __pageData,q as default};
